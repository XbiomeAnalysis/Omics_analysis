<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Omics analysis</title>
  <meta name="description" content="Tutorial for OMics analysis" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Omics analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Tutorial for OMics analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Omics analysis" />
  
  <meta name="twitter:description" content="Tutorial for OMics analysis" />
  

<meta name="author" content="Zhengnong Zhu, Yifan Zhao and Hua Zou" />


<meta name="date" content="2022-08-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  

<link rel="next" href="利用wgcna构建网络.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.23/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">OMics Data Analysis </a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Omics Analysis</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#wgcna-introduction"><i class="fa fa-check"></i><b>1.1</b> WGCNA Introduction</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#wgcna-步骤"><i class="fa fa-check"></i><b>1.1.1</b> WGCNA 步骤</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#halla-introduction"><i class="fa fa-check"></i><b>1.2</b> HAllA Introduction</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#available-pairwise-distance-metrics"><i class="fa fa-check"></i><b>1.2.1</b> Available pairwise distance metrics:</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#running-procedures"><i class="fa fa-check"></i><b>1.2.2</b> Running procedures</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#network-analysis"><i class="fa fa-check"></i><b>1.3</b> Network Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="利用wgcna构建网络.html"><a href="利用wgcna构建网络.html"><i class="fa fa-check"></i><b>2</b> 利用WGCNA构建网络</a><ul>
<li class="chapter" data-level="2.1" data-path="利用wgcna构建网络.html"><a href="利用wgcna构建网络.html#s-测序数据"><i class="fa fa-check"></i><b>2.1</b> 16S 测序数据</a><ul>
<li class="chapter" data-level="2.1.1" data-path="利用wgcna构建网络.html"><a href="利用wgcna构建网络.html#输入数据格式"><i class="fa fa-check"></i><b>2.1.1</b> 输入数据格式</a></li>
<li class="chapter" data-level="2.1.2" data-path="利用wgcna构建网络.html"><a href="利用wgcna构建网络.html#构建network"><i class="fa fa-check"></i><b>2.1.2</b> 构建network</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="利用wgcna构建网络.html"><a href="利用wgcna构建网络.html#宏基因组测序数据"><i class="fa fa-check"></i><b>2.2</b> 宏基因组测序数据</a></li>
<li class="chapter" data-level="2.3" data-path="利用wgcna构建网络.html"><a href="利用wgcna构建网络.html#代谢数据"><i class="fa fa-check"></i><b>2.3</b> 代谢数据</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="实例展示.html"><a href="实例展示.html"><i class="fa fa-check"></i><b>3</b> 实例展示</a><ul>
<li class="chapter" data-level="3.1" data-path="实例展示.html"><a href="实例展示.html#wgcna-demo"><i class="fa fa-check"></i><b>3.1</b> WGCNA demo</a><ul>
<li class="chapter" data-level="3.1.1" data-path="实例展示.html"><a href="实例展示.html#load-package"><i class="fa fa-check"></i><b>3.1.1</b> load package</a></li>
<li class="chapter" data-level="3.1.2" data-path="实例展示.html"><a href="实例展示.html#load-data"><i class="fa fa-check"></i><b>3.1.2</b> load data</a></li>
<li class="chapter" data-level="3.1.3" data-path="实例展示.html"><a href="实例展示.html#restructured-the-hierarchy-table"><i class="fa fa-check"></i><b>3.1.3</b> restructured the hierarchy table</a></li>
<li class="chapter" data-level="3.1.4" data-path="实例展示.html"><a href="实例展示.html#mgs-standardization"><i class="fa fa-check"></i><b>3.1.4</b> mgs standardization</a></li>
<li class="chapter" data-level="3.1.5" data-path="实例展示.html"><a href="实例展示.html#mgs-constructe-module"><i class="fa fa-check"></i><b>3.1.5</b> mgs constructe module</a></li>
<li class="chapter" data-level="3.1.6" data-path="实例展示.html"><a href="实例展示.html#metabolites-constructe-module"><i class="fa fa-check"></i><b>3.1.6</b> metabolites constructe module</a></li>
<li class="chapter" data-level="3.1.7" data-path="实例展示.html"><a href="实例展示.html#metabolites-mgs-and-metadata-association"><i class="fa fa-check"></i><b>3.1.7</b> metabolites, mgs and metadata association</a></li>
<li class="chapter" data-level="3.1.8" data-path="实例展示.html"><a href="实例展示.html#visualization-network"><i class="fa fa-check"></i><b>3.1.8</b> Visualization network</a></li>
<li class="chapter" data-level="3.1.9" data-path="实例展示.html"><a href="实例展示.html#session-info"><i class="fa fa-check"></i><b>3.1.9</b> Session Info</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="实例展示.html"><a href="实例展示.html#halla-demo"><i class="fa fa-check"></i><b>3.2</b> HAllA demo</a><ul>
<li class="chapter" data-level="3.2.1" data-path="实例展示.html"><a href="实例展示.html#登102集群-执行下述步骤"><i class="fa fa-check"></i><b>3.2.1</b> 登102集群: 执行下述步骤</a></li>
<li class="chapter" data-level="3.2.2" data-path="实例展示.html"><a href="实例展示.html#结果展示"><i class="fa fa-check"></i><b>3.2.2</b> 结果展示</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="network-analysis-1.html"><a href="network-analysis-1.html"><i class="fa fa-check"></i><b>4</b> Network Analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="network-analysis-1.html"><a href="network-analysis-1.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="network-analysis-1.html"><a href="network-analysis-1.html#loading-packages"><i class="fa fa-check"></i><b>4.2</b> Loading packages</a></li>
<li class="chapter" data-level="4.3" data-path="network-analysis-1.html"><a href="network-analysis-1.html#importing-data"><i class="fa fa-check"></i><b>4.3</b> Importing data</a></li>
<li class="chapter" data-level="4.4" data-path="network-analysis-1.html"><a href="network-analysis-1.html#data-curation"><i class="fa fa-check"></i><b>4.4</b> Data curation</a></li>
<li class="chapter" data-level="4.5" data-path="network-analysis-1.html"><a href="network-analysis-1.html#associations-among-features"><i class="fa fa-check"></i><b>4.5</b> Associations Among Features</a><ul>
<li class="chapter" data-level="4.5.1" data-path="network-analysis-1.html"><a href="network-analysis-1.html#single-network-with-spring-as-association-measure"><i class="fa fa-check"></i><b>4.5.1</b> Single network with SPRING as association measure</a></li>
<li class="chapter" data-level="4.5.2" data-path="network-analysis-1.html"><a href="network-analysis-1.html#single-network-with-pearson-correlation-as-association-measure"><i class="fa fa-check"></i><b>4.5.2</b> Single network with Pearson correlation as association measure</a></li>
<li class="chapter" data-level="4.5.3" data-path="network-analysis-1.html"><a href="network-analysis-1.html#single-network-with-spieceasi-correlation-as-association-measure"><i class="fa fa-check"></i><b>4.5.3</b> Single network with SpiecEasi correlation as association measure</a></li>
<li class="chapter" data-level="4.5.4" data-path="network-analysis-1.html"><a href="network-analysis-1.html#single-network-with-wgcna-bicor-as-association-measure"><i class="fa fa-check"></i><b>4.5.4</b> Single network with WGCNA (bicor) as association measure</a></li>
<li class="chapter" data-level="4.5.5" data-path="network-analysis-1.html"><a href="network-analysis-1.html#single-network-with-sparcc-correlation-as-association-measure"><i class="fa fa-check"></i><b>4.5.5</b> Single network with sparcc correlation as association measure</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="network-analysis-1.html"><a href="network-analysis-1.html#dissimilarity-based-networks"><i class="fa fa-check"></i><b>4.6</b> Dissimilarity-based Networks</a><ul>
<li class="chapter" data-level="4.6.1" data-path="network-analysis-1.html"><a href="network-analysis-1.html#building-network-module"><i class="fa fa-check"></i><b>4.6.1</b> Building network module</a></li>
<li class="chapter" data-level="4.6.2" data-path="network-analysis-1.html"><a href="network-analysis-1.html#visualizing-the-network-5"><i class="fa fa-check"></i><b>4.6.2</b> Visualizing the network</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="network-analysis-1.html"><a href="network-analysis-1.html#network-comparison"><i class="fa fa-check"></i><b>4.7</b> Network comparison</a><ul>
<li class="chapter" data-level="4.7.1" data-path="network-analysis-1.html"><a href="network-analysis-1.html#data-preparing"><i class="fa fa-check"></i><b>4.7.1</b> Data preparing</a></li>
<li class="chapter" data-level="4.7.2" data-path="network-analysis-1.html"><a href="network-analysis-1.html#building-network-model-5"><i class="fa fa-check"></i><b>4.7.2</b> Building network model</a></li>
<li class="chapter" data-level="4.7.3" data-path="network-analysis-1.html"><a href="network-analysis-1.html#network-analysis-2"><i class="fa fa-check"></i><b>4.7.3</b> Network analysis</a></li>
<li class="chapter" data-level="4.7.4" data-path="network-analysis-1.html"><a href="network-analysis-1.html#visualizing-the-network-6"><i class="fa fa-check"></i><b>4.7.4</b> Visualizing the network</a></li>
<li class="chapter" data-level="4.7.5" data-path="network-analysis-1.html"><a href="network-analysis-1.html#quantitative-network-comparison"><i class="fa fa-check"></i><b>4.7.5</b> Quantitative network comparison</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="network-analysis-1.html"><a href="network-analysis-1.html#systematic-information"><i class="fa fa-check"></i><b>4.8</b> Systematic Information</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Omics analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Omics analysis</h1>
<p class="author"><em>Zhengnong Zhu, Yifan Zhao and Hua Zou</em></p>
<p class="date"><em>2022-08-08</em></p>
</div>
<div id="omics-analysis" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapter 1</span> Omics Analysis<a href="index.html#omics-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>多组学整合分析随着高通量技术的广泛应用而生，研究人员可以从基因组、转录组、蛋白质组、交互组、表观基因组、代谢组、脂质体和微生物组等不同分子层面大规模获取组学数据，多组学整合数据分析使得生物学发生了革命性的变化，促进我们对生物过程和分子机制的深刻理解。单一组学分析方法可以提供不同生命进程或者疾病组与正常组相比差异的生物学过程的信息。但是，这些分析往往有局限性。多组学方法整合几个组学水平的信息，为生物机制提供了更多证据，从深层次挖掘候选关键因子；通过将各种组学，不同层面之间信息进行整合，构建基因调控网络，深层次理解各个分子之间的调控及因果关系，从而更深入的认识生物进程和疾病过程中复杂性状的分子机理和遗传基础。</p>
<p>公司常见组学数据类型：微生物组（宏基因组/16S），代谢组，转录组，临床/表型数据等。</p>
<div id="wgcna-introduction" class="section level2 hasAnchor">
<h2><span class="header-section-number">1.1</span> WGCNA Introduction<a href="index.html#wgcna-introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this book, we will introduce an method of multi-omics association analysis, entitled WGCNA. We will introduce usage and principle of WGCNA. Moreover, we will utilize GVHD data to illustate pipelines of WGCNA.</p>
<p>Correlation networks are increasingly being used in bioinformatics applications. For example, weighted gene co-expression network analysis is a systems biology method for describing the correlation patterns among genes across microarray samples. Weighted correlation network analysis (WGCNA) can be used for finding clusters (modules) of highly correlated genes, for summarizing such clusters using the module eigengene or an intramodular hub gene, for relating modules to one another and to external sample traits (using eigengene network methodology), and for calculating module membership measures. Correlation networks facilitate network based gene screening methods that can be used to identify candidate biomarkers or therapeutic targets. These methods have been successfully applied in various biological contexts, e.g. cancer, mouse genetics, yeast genetics, and analysis of brain imaging data. While parts of the correlation network methodology have been described in separate publications, there is a need to provide a user-friendly, comprehensive, and consistent software implementation and an accompanying tutorial.</p>
<p>The WGCNA R software package is a comprehensive collection of R functions for performing various aspects of weighted correlation network analysis. The package includes functions for network construction, module detection, gene selection, calculations of topological properties, data simulation, visualization, and interfacing with external software. Along with the R package we also present R software tutorials. While the methods development was motivated by gene expression data, the underlying data mining approach can be applied to a variety of different settings.</p>
<p><a href="https://horvath.genetics.ucla.edu/html/CoexpressionNetwork/Rpackages/WGCNA/">WGCNA source</a></p>
<div id="wgcna-步骤" class="section level3 hasAnchor">
<h3><span class="header-section-number">1.1.1</span> WGCNA 步骤<a href="index.html#wgcna-步骤" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure">
<img src="figure/WGCNA_workflow.png" alt="" />
<p class="caption">WGCNA workflow</p>
</div>
<div id="step-one-the-definition-of-a-gene-co-expression-similarity" class="section level4 hasAnchor">
<h4><span class="header-section-number">1.1.1.1</span> Step one: The Definition of a Gene Co-expression Similarity<a href="index.html#step-one-the-definition-of-a-gene-co-expression-similarity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>第一步首先确定需要构建网络模块使用那种 correlation 方法去计算节点之间的相关性，常见的方法为 Pearson correlation <span class="math inline">\(s_{ij} = |cor(i,j)|\)</span>，那么 similarity matrix <span class="math inline">\(S = [s_{ij}]\)</span>。当然，我们可以根据不同的数据使用不同的correlation算法。WGCNA默认的correlation算法为 <a href="https://en.wikipedia.org/wiki/Biweight_midcorrelation">bicor</a></p>
</div>
<div id="step-two-the-definition-of-a-family-of-adjacency-functions" class="section level4 hasAnchor">
<h4><span class="header-section-number">1.1.1.2</span> Step two: The Definition of a Family of Adjacency Functions<a href="index.html#step-two-the-definition-of-a-family-of-adjacency-functions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>第二步是确定邻接矩阵。将similarity matrix 转化为 adjacency matrix，需要一个阈值。确定这个阈值有两种方法，hard threshold 和 soft threshold。</p>
<p>hard threshold 通常使用signum函数作为连接函数来实现：</p>
<p><span class="math display">\[ 
a_{ij} = signum(s_{ij}, \tau) \equiv 
\begin{cases}
1 \quad if s_{ij} \geq \tau \\
0 \quad if s_{ij} \le \tau
\end{cases}
\]</span>
Hard threshoding using the signum function leads to intuitive network concepts, but it may lead to a loss of information: if <span class="math inline">\(\tau\)</span> has been set to 0.8, there will be no connection between two nodes if their similarity equals 0.79.</p>
<p>To avoid the disadvantage of hard thresholding, we propose two types of ‘soft’ adjacency functions: the sigmoid function</p>
<p><span class="math display">\[
a_{ij} = sigmoid(s_{ij}, \alpha, \tau_{0}) \equiv \frac{1}{1+e^{-\alpha(s_{ij}-\tau_{0})}}
\]</span>
the power adjacency function</p>
<p><span class="math display">\[
a_{ij} = power(s_{ij}, \beta) \equiv |s_{ij}|^\beta
\]</span>
<img src="figure/adjacency_matrix_for_function.png" alt="不同adjacency function构建的不同adjacency matrix" /></p>
<p>a图为使用sigmoid function的adjacency matrix，b图为使用power function的adjacency matrix。从图中我们可以看出power function的adjacency matrix能够保留大部分强相关连的关系，弱关联的关系则会被消除，能够减少节点之间的连接噪音。在我们的WGCNA流程中我们默认选择的是power function方法去构建adjacency。</p>
</div>
<div id="step-three-determining-the-parameters-of-the-adjacency-function" class="section level4 hasAnchor">
<h4><span class="header-section-number">1.1.1.3</span> Step three: Determining the Parameters of the Adjacency Function<a href="index.html#step-three-determining-the-parameters-of-the-adjacency-function" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>第三步是确定adjacency function的参数，对我们的流程来说，就是确定 <span class="math inline">\(\beta\)</span> 参数。为了确定参数，WGCNA提出了无标度拓扑网络（The Scale-free Topology）的概念。无标度网络在pathways, metabolic等生物数据上已经得到了验证，因此我们也假设基因的表达，微生物的生长关系也是符合无标度拓扑网络的概念。因此，当选择的参数需要满足无标度拓扑网络的构建。</p>
<p>什么是无标度网络？</p>
<div class="figure">
<img src="figure/scale_free_network.png" alt="" />
<p class="caption">scale-free topology</p>
</div>
<p>无标度网络的形象描述就是，有一个hub node，大部分的节点与其相连接，而这些节点本身连接较少。</p>
<p>怎么判断合适的 <span class="math inline">\(\beta\)</span>?</p>
<p>Earlier, we have described that he linear regression model fitting index <span class="math inline">\(R^2\)</span> can be used to quantify how well a network satisfies a scale-free topology. There is a natural trade-off between maximizing scale-free topology model fit(<span class="math inline">\(R^2\)</span>) and maintaining a high mean number of connections: parameter values that lead to an <span class="math inline">\(R^2\)</span> value close to 1 may lead to networks with very few connections.</p>
<div class="figure">
<img src="figure/select_beta.png" alt="" />
<p class="caption">select beta</p>
</div>
<p>如上图所示，当<span class="math inline">\(\beta\)</span>为6时，<span class="math inline">\(R^2\)</span>接近与1，但是任然保留较高的connections</p>
</div>
<div id="step-four-defining-a-measure-of-node-dissimilarity" class="section level4 hasAnchor">
<h4><span class="header-section-number">1.1.1.4</span> Step four: Defining a Measure of Node Dissimilarity<a href="index.html#step-four-defining-a-measure-of-node-dissimilarity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>第四步确定节点之间的不相似性距离。通过构建node之间的dissimilarity，然后用cluster方法可以将node（gene or others）划分到不同的module，同时也可以观察一个module中的node的连接紧密程度。</p>
<p>The topology overlap matrix (TOM) <span class="math inline">\(\Omega = [w_{ij}]\)</span></p>
<p><span class="math display">\[
w_{ij} = \frac{l_{ij} + a_{ij}}{min\{k_{i}, k_{j}\} + 1 - a_{ij}}
\]</span>
<span class="math inline">\(l_{ij} = \sum_{u}a_{iu}a_{uj}\)</span>, 表示i和j共享连接的u之间的关系乘的和</p>
<p><span class="math inline">\(k_{i} = \sum_{j=1}^na_{ij}\)</span>,表示i的所有连接和</p>
<p>dissimilarity measure is defined by <span class="math inline">\(d_{ij}^w = 1 - w_{ij}\)</span></p>
</div>
<div id="step-five-identifying-gene-modules" class="section level4 hasAnchor">
<h4><span class="header-section-number">1.1.1.5</span> Step five: Identifying Gene Modules<a href="index.html#step-five-identifying-gene-modules" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>第5步划分module。根据<span class="math inline">\(d_{ij}^w\)</span>, 用cluster方法划分module</p>
<div class="figure">
<img src="figure/split_modules.png" alt="" />
<p class="caption">split modules</p>
</div>
<p>a height cutoff value is chosen in the dendrogram such that some of the resulting branches correspond to dark squares(modules) along the diagonal of the TOM plot.</p>
</div>
<div id="step-six-relating-network-concepts-to-eeach-oter" class="section level4 hasAnchor">
<h4><span class="header-section-number">1.1.1.6</span> Step six: Relating Network Concepts to Eeach Oter<a href="index.html#step-six-relating-network-concepts-to-eeach-oter" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>第六步定义模块中的属性。</p>
<ol style="list-style-type: decimal">
<li>比如hub node。Each module can be represented by a centroid, e.g., an intramodular hub gene. Singular value decomposition</li>
</ol>
<p><span class="math display">\[
X^{(q)} = [x_{ij}^{(q)}] = (x_{1}^{(q)} \quad x_{2}^{(q)} \quad x_{3}^{(q)} \dots x_{n}^{(q)})^T \\
X^{(q)} = U^{(q)}D^{(q)}(V^{(q)})^T \\
V^{(q)} = (v_{1}^{(q)} \quad v_{2}^{(q)} \quad v_{3}^{(q)} \dots v_{m}^{(q)})
\]</span>
Module Eigengene:
<span class="math display">\[
E^{(q)} = v_{1}^{(q)}
\]</span>
2. module之间的correlation，如果两个module的correlation很高，可以合并两个module为一个。</p>
</div>
<div id="step-seven-relating-network-concepts-to-external-gene-or-sample-information" class="section level4 hasAnchor">
<h4><span class="header-section-number">1.1.1.7</span> Step seven: Relating Network Concepts to External Gene or Sample Information<a href="index.html#step-seven-relating-network-concepts-to-external-gene-or-sample-information" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>第七步，将module与外部数据相关联，找到感兴趣的module。</p>
<p>A main purpose of many network analysis is to relate a connectivity measure to external gene information. For example, In our cancer microarray application, we show that for brown module genes intramodular connectivity is highly correlated with prognostic significance for cancer surival.</p>
<div class="figure">
<img src="figure/relating_to_external_information.png" alt="" />
<p class="caption">relating to external information</p>
</div>
<p>如上图所示，临床数据（weight）与brown module最相关，表示这个module中的gene or node对weight有显著性的影响。</p>
</div>
</div>
</div>
<div id="halla-introduction" class="section level2 hasAnchor">
<h2><span class="header-section-number">1.2</span> HAllA Introduction<a href="index.html#halla-introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>HAllA (Hierarchical All-against-All association) 是一个针对多维度、异质型数据集的多重关联分析工具。可用于连续型/分类型数值数据，且在同质型（homogeneous）数据集（所有数值皆相同类型，例如：RNA-seq 基因表現）与异质型（heterogeneous）数据集（不同单位或类型的数值，例如：病患临床指标）皆可高效分析。在目前微生物研究中，HAllA是一個常用于微生物组-代谢、微生物组-临床指标、微生物组-转录组（基因表現、miRNA、GO） 等关联分析的重要工具。</p>
<p><a href="https://huttenhower.sph.harvard.edu/halla">HAllA source</a></p>
<div class="figure">
<img src="figure/HAllA_workflow.png" alt="" />
<p class="caption">HAllA workflow</p>
</div>
<div id="available-pairwise-distance-metrics" class="section level3 hasAnchor">
<h3><span class="header-section-number">1.2.1</span> Available pairwise distance metrics:<a href="index.html#available-pairwise-distance-metrics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>spearman (default for continuous data)</p></li>
<li><p>pearson</p></li>
<li><p>mi (A set of properties of Mutual Information result from definition. default for mixed/categorical data)</p></li>
<li><p>nmi (Normalized Mutual Information)</p></li>
<li><p>xicor (Chatterjee correlation, uses rank differences to assess the degree to which one variable is a measurable function of another，适用于离散、非线性关系数据)</p></li>
<li><p>dcor (measures not necessarily linear dependency of two random variables with possibly different dimensions)</p></li>
</ul>
<div class="figure">
<img src="figure/HAllA_dataType.png" alt="" />
<p class="caption">HAllA correlation methods</p>
</div>
</div>
<div id="running-procedures" class="section level3 hasAnchor">
<h3><span class="header-section-number">1.2.2</span> Running procedures<a href="index.html#running-procedures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>step1</strong></p>
<p>The pairwise similarity matrix between all features in X and Y is computed with a specified similarity measure, such as Spearman correlation and normalized mutual information (NMI). This step then generates the p-value and q-value tables.</p>
<p>Note that for handling heterogeneous data, all continuous features are first discretized into bins using a specified binning method.</p>
<p><strong>step2</strong></p>
<p>Hierarchical clustering on the features in each dataset is performed using the converted similarity measure used in step 1. It produces a tree for each dataset.</p>
<p><strong>step3</strong></p>
<p>Finding densely-associated blocks(pseudocode):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="index.html#cb1-1"></a><span class="kw">def</span> find_densely_associated_blocks(x, y):</span>
<span id="cb1-2"><a href="index.html#cb1-2"></a>    x_features <span class="op">=</span> <span class="bu">all</span> features <span class="kw">in</span> x</span>
<span id="cb1-3"><a href="index.html#cb1-3"></a>    y_features <span class="op">=</span> <span class="bu">all</span> features <span class="kw">in</span> y</span>
<span id="cb1-4"><a href="index.html#cb1-4"></a>    <span class="cf">if</span> is_densely_associated(x_features, y_features):</span>
<span id="cb1-5"><a href="index.html#cb1-5"></a>        report block <span class="kw">and</span> terminate</span>
<span id="cb1-6"><a href="index.html#cb1-6"></a>    <span class="cf">else</span>:</span>
<span id="cb1-7"><a href="index.html#cb1-7"></a>        <span class="co"># bifurcate one according to Gini impurities of the splits</span></span>
<span id="cb1-8"><a href="index.html#cb1-8"></a>        x_branches, y_branches <span class="op">=</span> bifurcate_one_of(x, y)</span>
<span id="cb1-9"><a href="index.html#cb1-9"></a>        <span class="cf">if</span> both x <span class="kw">and</span> y are leaves:</span>
<span id="cb1-10"><a href="index.html#cb1-10"></a>            terminate</span>
<span id="cb1-11"><a href="index.html#cb1-11"></a>        <span class="cf">for</span> each x_branch <span class="kw">and</span> y_branch <span class="kw">in</span> x_branches <span class="kw">and</span> y_branches:</span>
<span id="cb1-12"><a href="index.html#cb1-12"></a>            find_densely_associated_blocks(x_branch, y_branch)</span>
<span id="cb1-13"><a href="index.html#cb1-13"></a>initial function call: find_densely_associated_blocks(X_root, Y_root)</span></code></pre></div>
<p>For example, given two datasets of X (features: X1, X2, X3, X4, X5) and Y (features: Y1, Y2, Y3, Y4) both hierarchically clustered in X tree and Y tree, the algorithm first evaluates the roots of both trees and checks if the block consisting of all features of X and Y are densely-associated (if %significance (%reject) &gt;= (1 - FNR)%).</p>
<p>If the block is not densely-associated, the algorithm would bifurcate one of the trees. It would pick one of:</p>
<p>·[X1 X2][X3 X4 X5] &gt;&lt; [Y1 Y2 Y3 Y4] or</p>
<p>·[X1 X2 X3 X4 X5] &gt;&lt; [Y1 Y2 Y3][Y4]</p>
<p>based on the Gini impurity of the splits (pick the split that produces a lower weighted Gini impurity),</p>
<p>Once it picks the split with the lower impurity (let’s say the first split), it will iteratively evaluate the branches:</p>
<p>·find densely-associated blocks in [X1 X2] vs [Y1 Y2 Y3 Y4], and</p>
<p>·find densely-associated blocks in [X3 X4 X5] vs [Y1 Y2 Y3 Y4]</p>
<p>and keep going until it terminates.</p>
</div>
</div>
<div id="network-analysis" class="section level2 hasAnchor">
<h2><span class="header-section-number">1.3</span> Network Analysis<a href="index.html#network-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>Estimating microbial association networks from high-throughput sequencing data is a common exploratory data analysis approach aiming at understanding the complex interplay of microbial communities in their natural habitat. Statistical network estimation workflows comprise several analysis steps, including methods for zero handling, data normalization and computing microbial associations. Since microbial interactions are likely to change between conditions, e.g. between healthy individuals and patients, identifying network differences between groups is often an integral secondary analysis step.</p>
</blockquote>

</div>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="利用wgcna构建网络.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/XbiomeAnalysis/OMicsAnalysis/blob/main/index.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["OMics analysis workflow.pdf", "OMics analysis workflow.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
