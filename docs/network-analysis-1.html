<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Network Analysis | Omics analysis</title>
  <meta name="description" content="Tutorial for OMics analysis" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Network Analysis | Omics analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Tutorial for OMics analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Network Analysis | Omics analysis" />
  
  <meta name="twitter:description" content="Tutorial for OMics analysis" />
  

<meta name="author" content="Zhengnong Zhu, Yifan Zhao and Hua Zou" />


<meta name="date" content="2022-08-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="实例展示.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.23/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">OMics Data Analysis </a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Omics Analysis</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#wgcna-introduction"><i class="fa fa-check"></i><b>1.1</b> WGCNA Introduction</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#wgcna-步骤"><i class="fa fa-check"></i><b>1.1.1</b> WGCNA 步骤</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#halla-introduction"><i class="fa fa-check"></i><b>1.2</b> HAllA Introduction</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#available-pairwise-distance-metrics"><i class="fa fa-check"></i><b>1.2.1</b> Available pairwise distance metrics:</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#running-procedures"><i class="fa fa-check"></i><b>1.2.2</b> Running procedures</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#network-analysis"><i class="fa fa-check"></i><b>1.3</b> Network Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="利用wgcna构建网络.html"><a href="利用wgcna构建网络.html"><i class="fa fa-check"></i><b>2</b> 利用WGCNA构建网络</a><ul>
<li class="chapter" data-level="2.1" data-path="利用wgcna构建网络.html"><a href="利用wgcna构建网络.html#s-测序数据"><i class="fa fa-check"></i><b>2.1</b> 16S 测序数据</a><ul>
<li class="chapter" data-level="2.1.1" data-path="利用wgcna构建网络.html"><a href="利用wgcna构建网络.html#输入数据格式"><i class="fa fa-check"></i><b>2.1.1</b> 输入数据格式</a></li>
<li class="chapter" data-level="2.1.2" data-path="利用wgcna构建网络.html"><a href="利用wgcna构建网络.html#构建network"><i class="fa fa-check"></i><b>2.1.2</b> 构建network</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="利用wgcna构建网络.html"><a href="利用wgcna构建网络.html#宏基因组测序数据"><i class="fa fa-check"></i><b>2.2</b> 宏基因组测序数据</a></li>
<li class="chapter" data-level="2.3" data-path="利用wgcna构建网络.html"><a href="利用wgcna构建网络.html#代谢数据"><i class="fa fa-check"></i><b>2.3</b> 代谢数据</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="实例展示.html"><a href="实例展示.html"><i class="fa fa-check"></i><b>3</b> 实例展示</a><ul>
<li class="chapter" data-level="3.1" data-path="实例展示.html"><a href="实例展示.html#wgcna-demo"><i class="fa fa-check"></i><b>3.1</b> WGCNA demo</a><ul>
<li class="chapter" data-level="3.1.1" data-path="实例展示.html"><a href="实例展示.html#load-package"><i class="fa fa-check"></i><b>3.1.1</b> load package</a></li>
<li class="chapter" data-level="3.1.2" data-path="实例展示.html"><a href="实例展示.html#load-data"><i class="fa fa-check"></i><b>3.1.2</b> load data</a></li>
<li class="chapter" data-level="3.1.3" data-path="实例展示.html"><a href="实例展示.html#restructured-the-hierarchy-table"><i class="fa fa-check"></i><b>3.1.3</b> restructured the hierarchy table</a></li>
<li class="chapter" data-level="3.1.4" data-path="实例展示.html"><a href="实例展示.html#mgs-standardization"><i class="fa fa-check"></i><b>3.1.4</b> mgs standardization</a></li>
<li class="chapter" data-level="3.1.5" data-path="实例展示.html"><a href="实例展示.html#mgs-constructe-module"><i class="fa fa-check"></i><b>3.1.5</b> mgs constructe module</a></li>
<li class="chapter" data-level="3.1.6" data-path="实例展示.html"><a href="实例展示.html#metabolites-constructe-module"><i class="fa fa-check"></i><b>3.1.6</b> metabolites constructe module</a></li>
<li class="chapter" data-level="3.1.7" data-path="实例展示.html"><a href="实例展示.html#metabolites-mgs-and-metadata-association"><i class="fa fa-check"></i><b>3.1.7</b> metabolites, mgs and metadata association</a></li>
<li class="chapter" data-level="3.1.8" data-path="实例展示.html"><a href="实例展示.html#visualization-network"><i class="fa fa-check"></i><b>3.1.8</b> Visualization network</a></li>
<li class="chapter" data-level="3.1.9" data-path="实例展示.html"><a href="实例展示.html#session-info"><i class="fa fa-check"></i><b>3.1.9</b> Session Info</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="实例展示.html"><a href="实例展示.html#halla-demo"><i class="fa fa-check"></i><b>3.2</b> HAllA demo</a><ul>
<li class="chapter" data-level="3.2.1" data-path="实例展示.html"><a href="实例展示.html#登102集群-执行下述步骤"><i class="fa fa-check"></i><b>3.2.1</b> 登102集群: 执行下述步骤</a></li>
<li class="chapter" data-level="3.2.2" data-path="实例展示.html"><a href="实例展示.html#结果展示"><i class="fa fa-check"></i><b>3.2.2</b> 结果展示</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="network-analysis-1.html"><a href="network-analysis-1.html"><i class="fa fa-check"></i><b>4</b> Network Analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="network-analysis-1.html"><a href="network-analysis-1.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="network-analysis-1.html"><a href="network-analysis-1.html#loading-packages"><i class="fa fa-check"></i><b>4.2</b> Loading packages</a></li>
<li class="chapter" data-level="4.3" data-path="network-analysis-1.html"><a href="network-analysis-1.html#importing-data"><i class="fa fa-check"></i><b>4.3</b> Importing data</a></li>
<li class="chapter" data-level="4.4" data-path="network-analysis-1.html"><a href="network-analysis-1.html#data-curation"><i class="fa fa-check"></i><b>4.4</b> Data curation</a></li>
<li class="chapter" data-level="4.5" data-path="network-analysis-1.html"><a href="network-analysis-1.html#associations-among-features"><i class="fa fa-check"></i><b>4.5</b> Associations Among Features</a><ul>
<li class="chapter" data-level="4.5.1" data-path="network-analysis-1.html"><a href="network-analysis-1.html#single-network-with-spring-as-association-measure"><i class="fa fa-check"></i><b>4.5.1</b> Single network with SPRING as association measure</a></li>
<li class="chapter" data-level="4.5.2" data-path="network-analysis-1.html"><a href="network-analysis-1.html#single-network-with-pearson-correlation-as-association-measure"><i class="fa fa-check"></i><b>4.5.2</b> Single network with Pearson correlation as association measure</a></li>
<li class="chapter" data-level="4.5.3" data-path="network-analysis-1.html"><a href="network-analysis-1.html#single-network-with-spieceasi-correlation-as-association-measure"><i class="fa fa-check"></i><b>4.5.3</b> Single network with SpiecEasi correlation as association measure</a></li>
<li class="chapter" data-level="4.5.4" data-path="network-analysis-1.html"><a href="network-analysis-1.html#single-network-with-wgcna-bicor-as-association-measure"><i class="fa fa-check"></i><b>4.5.4</b> Single network with WGCNA (bicor) as association measure</a></li>
<li class="chapter" data-level="4.5.5" data-path="network-analysis-1.html"><a href="network-analysis-1.html#single-network-with-sparcc-correlation-as-association-measure"><i class="fa fa-check"></i><b>4.5.5</b> Single network with sparcc correlation as association measure</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="network-analysis-1.html"><a href="network-analysis-1.html#dissimilarity-based-networks"><i class="fa fa-check"></i><b>4.6</b> Dissimilarity-based Networks</a><ul>
<li class="chapter" data-level="4.6.1" data-path="network-analysis-1.html"><a href="network-analysis-1.html#building-network-module"><i class="fa fa-check"></i><b>4.6.1</b> Building network module</a></li>
<li class="chapter" data-level="4.6.2" data-path="network-analysis-1.html"><a href="network-analysis-1.html#visualizing-the-network-5"><i class="fa fa-check"></i><b>4.6.2</b> Visualizing the network</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="network-analysis-1.html"><a href="network-analysis-1.html#network-comparison"><i class="fa fa-check"></i><b>4.7</b> Network comparison</a><ul>
<li class="chapter" data-level="4.7.1" data-path="network-analysis-1.html"><a href="network-analysis-1.html#data-preparing"><i class="fa fa-check"></i><b>4.7.1</b> Data preparing</a></li>
<li class="chapter" data-level="4.7.2" data-path="network-analysis-1.html"><a href="network-analysis-1.html#building-network-model-5"><i class="fa fa-check"></i><b>4.7.2</b> Building network model</a></li>
<li class="chapter" data-level="4.7.3" data-path="network-analysis-1.html"><a href="network-analysis-1.html#network-analysis-2"><i class="fa fa-check"></i><b>4.7.3</b> Network analysis</a></li>
<li class="chapter" data-level="4.7.4" data-path="network-analysis-1.html"><a href="network-analysis-1.html#visualizing-the-network-6"><i class="fa fa-check"></i><b>4.7.4</b> Visualizing the network</a></li>
<li class="chapter" data-level="4.7.5" data-path="network-analysis-1.html"><a href="network-analysis-1.html#quantitative-network-comparison"><i class="fa fa-check"></i><b>4.7.5</b> Quantitative network comparison</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="network-analysis-1.html"><a href="network-analysis-1.html#systematic-information"><i class="fa fa-check"></i><b>4.8</b> Systematic Information</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Omics analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="network-analysis-1" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapter 4</span> Network Analysis<a href="network-analysis-1.html#network-analysis-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction" class="section level2 hasAnchor">
<h2><span class="header-section-number">4.1</span> Introduction<a href="network-analysis-1.html#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>Estimating microbial association networks from high-throughput sequencing data is a common exploratory data analysis approach aiming at understanding the complex interplay of microbial communities in their natural habitat. Statistical network estimation workflows comprise several analysis steps, including methods for zero handling, data normalization and computing microbial associations. Since microbial interactions are likely to change between conditions, e.g. between healthy individuals and patients, identifying network differences between groups is often an integral secondary analysis step.</p>
</blockquote>
<p>NetCoMi (Network Construction and Comparison for Microbiome Data) <span class="citation">(Peschel et al. <a href="#ref-peschel2021netcomi" role="doc-biblioref">2021</a>)</span> provides functionality for constructing, analyzing, and comparing networks suitable for the application on microbial compositional data.</p>
<p>The following information is from <a href="https://github.com/stefpeschel/NetCoMi">NetCoMi github</a>.</p>
<p><strong>Association measures:</strong></p>
<ul>
<li>Pearson coefficient
(<a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/cor"><code>cor()</code></a>
from <code>stats</code> package)</li>
<li>Spearman coefficient
(<a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/cor"><code>cor()</code></a>
from <code>stats</code> package)</li>
<li>Biweight Midcorrelation
<a href="https://rdrr.io/cran/WGCNA/man/bicor.html"><code>bicor()</code></a> from <code>WGCNA</code>
package</li>
<li>SparCC
(<a href="https://rdrr.io/github/zdk123/SpiecEasi/man/sparcc.html"><code>sparcc()</code></a>
from <code>SpiecEasi</code> package)</li>
<li>CCLasso (<a href="https://github.com/huayingfang/CCLasso">R code on GitHub</a>)</li>
<li>CCREPE
(<a href="https://bioconductor.org/packages/release/bioc/html/ccrepe.html"><code>ccrepe</code></a>
package)</li>
<li>SpiecEasi (<a href="https://github.com/zdk123/SpiecEasi"><code>SpiecEasi</code></a>
package)</li>
<li>SPRING (<a href="https://github.com/GraceYoon/SPRING"><code>SPRING</code></a> package)</li>
<li>gCoda (<a href="https://github.com/huayingfang/gCoda">R code on GitHub</a>)</li>
<li>propr
(<a href="https://cran.r-project.org/web/packages/propr/index.html"><code>propr</code></a>
package)</li>
</ul>
<p><strong>Dissimilarity measures:</strong></p>
<ul>
<li>Euclidean distance
(<a href="https://www.rdocumentation.org/packages/vegan/versions/2.4-2/topics/vegdist"><code>vegdist()</code></a>
from <code>vegan</code> package)</li>
<li>Bray-Curtis dissimilarity
(<a href="https://www.rdocumentation.org/packages/vegan/versions/2.4-2/topics/vegdist"><code>vegdist()</code></a>
from <code>vegan</code> package)</li>
<li>Kullback-Leibler divergence (KLD)
(<a href="https://rdrr.io/cran/LaplacesDemon/man/KLD.html"><code>KLD()</code></a> from
<code>LaplacesDemon</code> package)</li>
<li>Jeffrey divergence (own code using
<a href="https://rdrr.io/cran/LaplacesDemon/man/KLD.html"><code>KLD()</code></a> from
<code>LaplacesDemon</code> package)</li>
<li>Jensen-Shannon divergence (own code using
<a href="https://rdrr.io/cran/LaplacesDemon/man/KLD.html"><code>KLD()</code></a> from
<code>LaplacesDemon</code> package)</li>
<li>Compositional KLD (own implementation following [Martín-Fernández
et al., 1999])</li>
<li>Aitchison distance
(<a href="https://www.rdocumentation.org/packages/vegan/versions/2.4-2/topics/vegdist"><code>vegdist()</code></a>
and <a href="https://rdrr.io/github/zdk123/SpiecEasi/man/clr.html"><code>clr()</code></a>
from <code>SpiecEasi</code> package)</li>
</ul>
<p><strong>Methods for zero replacement:</strong></p>
<ul>
<li>Adding a predefined pseudo count</li>
<li>Multiplicative replacement
(<a href="https://rdrr.io/cran/zCompositions/man/multRepl.html"><code>multRepl</code></a>
from <code>zCompositions</code> package)</li>
<li>Modified EM alr-algorithm
(<a href="https://rdrr.io/cran/zCompositions/man/lrEM.html"><code>lrEM</code></a> from
<code>zCompositions</code> package)</li>
<li>Bayesian-multiplicative replacement
(<a href="https://rdrr.io/cran/zCompositions/man/cmultRepl.html"><code>cmultRepl</code></a>
from <code>zCompositions</code> package)</li>
</ul>
<p><strong>Normalization methods:</strong></p>
<ul>
<li>Total Sum Scaling (TSS) (own implementation)</li>
<li>Cumulative Sum Scaling (CSS) (<a href=""><code>cumNormMat</code></a> from <code>metagenomeSeq</code>
package)</li>
<li>Common Sum Scaling (COM) (own implementation)</li>
<li>Rarefying (<a href=""><code>rrarefy</code></a> from <code>vegan</code> package)</li>
<li>Variance Stabilizing Transformation (VST)
(<a href=""><code>varianceStabilizingTransformation</code></a> from <code>DESeq2</code> package)</li>
<li>Centered log-ratio (clr) transformation
(<a href="https://rdrr.io/github/zdk123/SpiecEasi/man/clr.html"><code>clr()</code></a>
from <code>SpiecEasi</code> package))</li>
</ul>
<p>TSS, CSS, COM, VST, and the clr transformation are described in [Badri
et al., 2020].</p>
</div>
<div id="loading-packages" class="section level2 hasAnchor">
<h2><span class="header-section-number">4.2</span> Loading packages<a href="network-analysis-1.html#loading-packages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="network-analysis-1.html#cb155-1"></a>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">warning =</span> F)</span>
<span id="cb155-2"><a href="network-analysis-1.html#cb155-2"></a></span>
<span id="cb155-3"><a href="network-analysis-1.html#cb155-3"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb155-4"><a href="network-analysis-1.html#cb155-4"></a><span class="kw">library</span>(tibble)</span>
<span id="cb155-5"><a href="network-analysis-1.html#cb155-5"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb155-6"><a href="network-analysis-1.html#cb155-6"></a><span class="kw">library</span>(plotly)</span>
<span id="cb155-7"><a href="network-analysis-1.html#cb155-7"></a><span class="kw">library</span>(SummarizedExperiment)</span>
<span id="cb155-8"><a href="network-analysis-1.html#cb155-8"></a></span>
<span id="cb155-9"><a href="network-analysis-1.html#cb155-9"></a><span class="co"># devtools::install_github(&quot;pcastellanoescuder/POMA&quot;)</span></span>
<span id="cb155-10"><a href="network-analysis-1.html#cb155-10"></a><span class="co">#library(POMA)</span></span>
<span id="cb155-11"><a href="network-analysis-1.html#cb155-11"></a><span class="kw">library</span>(ggraph)</span>
<span id="cb155-12"><a href="network-analysis-1.html#cb155-12"></a></span>
<span id="cb155-13"><a href="network-analysis-1.html#cb155-13"></a><span class="co"># installing package</span></span>
<span id="cb155-14"><a href="network-analysis-1.html#cb155-14"></a><span class="co"># devtools::install_github(&quot;stefpeschel/NetCoMi&quot;,</span></span>
<span id="cb155-15"><a href="network-analysis-1.html#cb155-15"></a><span class="co">#                          dependencies = c(&quot;Depends&quot;, &quot;Imports&quot;, &quot;LinkingTo&quot;),</span></span>
<span id="cb155-16"><a href="network-analysis-1.html#cb155-16"></a><span class="co">#                          repos = c(&quot;https://cloud.r-project.org/&quot;,</span></span>
<span id="cb155-17"><a href="network-analysis-1.html#cb155-17"></a><span class="co">#                                    BiocManager::repositories()))</span></span>
<span id="cb155-18"><a href="network-analysis-1.html#cb155-18"></a><span class="co"># devtools::install_github(&quot;GraceYoon/SPRING&quot;, force = TRUE)</span></span>
<span id="cb155-19"><a href="network-analysis-1.html#cb155-19"></a><span class="co"># devtools::install_github(&quot;zdk123/SpiecEasi&quot;, force = TRUE)</span></span>
<span id="cb155-20"><a href="network-analysis-1.html#cb155-20"></a><span class="kw">library</span>(NetCoMi)</span>
<span id="cb155-21"><a href="network-analysis-1.html#cb155-21"></a><span class="kw">library</span>(SPRING)</span>
<span id="cb155-22"><a href="network-analysis-1.html#cb155-22"></a><span class="kw">library</span>(SpiecEasi)</span>
<span id="cb155-23"><a href="network-analysis-1.html#cb155-23"></a></span>
<span id="cb155-24"><a href="network-analysis-1.html#cb155-24"></a></span>
<span id="cb155-25"><a href="network-analysis-1.html#cb155-25"></a><span class="co"># rm(list = ls())</span></span>
<span id="cb155-26"><a href="network-analysis-1.html#cb155-26"></a><span class="kw">options</span>(<span class="dt">stringsAsFactors =</span> F)</span>
<span id="cb155-27"><a href="network-analysis-1.html#cb155-27"></a><span class="kw">options</span>(<span class="dt">future.globals.maxSize =</span> <span class="dv">1000</span> <span class="op">*</span><span class="st"> </span><span class="dv">1024</span><span class="op">^</span><span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="importing-data" class="section level2 hasAnchor">
<h2><span class="header-section-number">4.3</span> Importing data<a href="network-analysis-1.html#importing-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The input data sets are from the previous chapter.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="network-analysis-1.html#cb156-1"></a>se_filter &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;./dataset/POMA/se_filter.RDS&quot;</span>)</span></code></pre></div>
</div>
<div id="data-curation" class="section level2 hasAnchor">
<h2><span class="header-section-number">4.4</span> Data curation<a href="network-analysis-1.html#data-curation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="network-analysis-1.html#cb157-1"></a>features_tab &lt;-<span class="st"> </span>SummarizedExperiment<span class="op">::</span><span class="kw">assay</span>(se_filter) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb157-2"><a href="network-analysis-1.html#cb157-2"></a><span class="st">  </span><span class="kw">t</span>()</span>
<span id="cb157-3"><a href="network-analysis-1.html#cb157-3"></a>features_tab[<span class="kw">is.na</span>(features_tab)] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb157-4"><a href="network-analysis-1.html#cb157-4"></a></span>
<span id="cb157-5"><a href="network-analysis-1.html#cb157-5"></a><span class="kw">head</span>(features_tab)</span></code></pre></div>
<pre><code>##           M_52603  M_19130   M_39270 M_35186 M_34214  M_49617  M_52710  M_53189   M_34419  M_36600  M_54885  M_32350 M_55041   M_48258
## P101001  94392176 25632184  959249.2 8141286 8284910 381540.1 47739292 392911.0 306346432  9887348 298886.1 627613.7 3655240 181136336
## P101004 115155104 25106562  785895.0 4303854 7923489 588488.2 43678784 300383.9 263333424  9703074 356274.3 339586.8 1637351 115752200
## P101007  79582632 31371314 1903592.4 7129884 9211485 464548.8 53975068 539361.5 191261648  6431966 393623.0 662555.6 7284474 102036920
## P101009 118408760 27787270  863701.9 5394354 8559147 497342.0 47619564 487186.2 232171184 11914472 599783.6 492430.9 3065707 118663320
## P101010  92508664 26685844 1177860.8 6270727 7623603 457409.1 61906028 236719.5 183104336  9366287 280123.8 373484.2 2493687 154183360
## P101011  94076424 27780988  638271.3 4292087 6074633 238781.8 40534280 279118.7 164623888  6003700 349482.3 608671.7 2653816  76137216
##         M_35628  M_33230   M_52462  M_52464   M_52454   M_52610   M_42446   M_52461  M_52616   M_33955 M_35631   M_42450  M_52447
## P101001 6548460 19098412 486910976  6794782 274026048 206279104 712253440 486655872 12365879 448634784 4035864 358896736 30252208
## P101004 3455001 10641834 380887616  4090405 282066016 253920496 807180352 439253152 10655923 413690720 3446139 282910752 19424238
## P101007 3640571 14977371 515795264 13183206 309709728 316142400 715500800 448578400 14010174 368849632 3764448 404918560 57376512
## P101009 5087503 13575508 390977568  7596680 325723168 232534688 742576768 473622240 14814230 365712768 3444159 298822048 26429340
## P101010 5244878 19464998 478479936  5395172 382690720 262177072 642967424 647036736 12873290 376101984 3276579 373251712 21732290
## P101011 2238570  8797510 420938976  4854076 261022832 264648720 728199680 378921056 13152187 348108832 2364665 335196864 21960100
##          M_52449   M_52452   M_52438   M_33961 M_42398  M_47403  M_57547   M_19266   M_63739  M_57663 M_42489  M_37253  M_45095
## P101001 43173148 510461472 181406848 191147264 6137137 209255.5 169297.7 176944.80  761146.2 719237.9 2865827 411578.0 751527.3
## P101004 30030992 573170816 122556968 166379712 5143481 220424.3 426227.5      0.00  549097.4 364556.1 1546570 425030.0 378033.7
## P101007 50766284 588643712 181572112 189915296 7412535 369675.0 561078.5 385203.22  792883.2 500680.8 1403190 742298.0 589506.3
## P101009 43420376 631965888 208484000 186599152 5421984 172995.7 457043.3      0.00  727360.0 523549.1 1653830 466825.0 503910.2
## P101010 43622724 590247424 306379392 217632736 5767624 168503.4 602024.4      0.00  913964.4 455201.1 1007203 232876.0 489013.9
## P101011 39447380 560182336 136970272 170865408 3588338 375137.6 304329.9  90888.59 1609550.0 449288.0 1818438 651777.4 785751.6
##           M_53229   M_55072  M_47118  M_35253   M_46115 M_62952  M_63681 M_63361
## P101001  768160.4  488544.9 281162.7 27446600 1578011.4 5104806 434480.3 2540280
## P101004  953194.9  653107.0 362380.0 28088842  440408.7 3084011 373229.5 2165454
## P101007 1619436.8  522721.5 482046.2 21613430  794592.2 4728273 400386.6 2231037
## P101009  877530.2  873616.8 619943.9 28872470  671497.6 4140767 301840.8       0
## P101010  993923.4  864624.8 677774.7 25375946 1133763.9 2434359 548330.4 1125607
## P101011 1092817.9 1360312.8 208040.6 17388928 1635119.5 5722723 344799.8       0</code></pre>
</div>
<div id="associations-among-features" class="section level2 hasAnchor">
<h2><span class="header-section-number">4.5</span> Associations Among Features<a href="network-analysis-1.html#associations-among-features" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="single-network-with-spring-as-association-measure" class="section level3 hasAnchor">
<h3><span class="header-section-number">4.5.1</span> Single network with SPRING as association measure<a href="network-analysis-1.html#single-network-with-spring-as-association-measure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>InputData: numeric matrix. Can be a count matrix (rows are samples, columns are Features).</p></li>
<li><p>Filtered criterion:</p>
<ul>
<li><p>Only samples with a total number of reads of at least 1000 are included (argument filtSamp).</p></li>
<li><p>Only the 50 taxa with highest frequency are included (argument filtTax).</p></li>
</ul></li>
<li><p>Method to compute the associations between features (argument measure).</p></li>
<li><p>Normalization method:</p>
<ul>
<li><p>normMethod: none.</p></li>
<li><p>zeroMethod: none.</p></li>
<li><p>sparsMethod: none.</p></li>
</ul></li>
</ul>
<div id="building-network-model" class="section level4 hasAnchor">
<h4><span class="header-section-number">4.5.1.1</span> Building network model<a href="network-analysis-1.html#building-network-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="network-analysis-1.html#cb159-1"></a>net_single &lt;-<span class="st"> </span><span class="kw">netConstruct</span>(features_tab,</span>
<span id="cb159-2"><a href="network-analysis-1.html#cb159-2"></a>                           <span class="dt">filtTax =</span> <span class="st">&quot;highestFreq&quot;</span>,</span>
<span id="cb159-3"><a href="network-analysis-1.html#cb159-3"></a>                           <span class="dt">filtTaxPar =</span> <span class="kw">list</span>(<span class="dt">highestFreq =</span> <span class="dv">50</span>),</span>
<span id="cb159-4"><a href="network-analysis-1.html#cb159-4"></a>                           <span class="dt">filtSamp =</span> <span class="st">&quot;totalReads&quot;</span>,</span>
<span id="cb159-5"><a href="network-analysis-1.html#cb159-5"></a>                           <span class="dt">filtSampPar =</span> <span class="kw">list</span>(<span class="dt">totalReads =</span> <span class="dv">100</span>),</span>
<span id="cb159-6"><a href="network-analysis-1.html#cb159-6"></a>                           <span class="dt">measure =</span> <span class="st">&quot;spring&quot;</span>,</span>
<span id="cb159-7"><a href="network-analysis-1.html#cb159-7"></a>                           <span class="dt">measurePar =</span> <span class="kw">list</span>(<span class="dt">nlambda =</span> <span class="dv">10</span>, </span>
<span id="cb159-8"><a href="network-analysis-1.html#cb159-8"></a>                                             <span class="dt">rep.num =</span> <span class="dv">10</span>),</span>
<span id="cb159-9"><a href="network-analysis-1.html#cb159-9"></a>                           <span class="dt">normMethod =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb159-10"><a href="network-analysis-1.html#cb159-10"></a>                           <span class="dt">zeroMethod =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb159-11"><a href="network-analysis-1.html#cb159-11"></a>                           <span class="dt">sparsMethod =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb159-12"><a href="network-analysis-1.html#cb159-12"></a>                           <span class="dt">dissFunc =</span> <span class="st">&quot;signed&quot;</span>,</span>
<span id="cb159-13"><a href="network-analysis-1.html#cb159-13"></a>                           <span class="dt">verbose =</span> <span class="dv">3</span>,</span>
<span id="cb159-14"><a href="network-analysis-1.html#cb159-14"></a>                           <span class="dt">seed =</span> <span class="dv">123</span>)</span></code></pre></div>
<pre><code>## Data filtering ...</code></pre>
<pre><code>## 48 taxa and 45 samples remaining.</code></pre>
<pre><code>## 
## Calculate &#39;spring&#39; associations ...</code></pre>
<pre><code>## The input is identified as the covariance matrix.
## Conducting Meinshausen &amp; Buhlmann graph estimation (mb)....done
## The input is identified as the covariance matrix.
## Conducting Meinshausen &amp; Buhlmann graph estimation (mb)....done
## The input is identified as the covariance matrix.
## Conducting Meinshausen &amp; Buhlmann graph estimation (mb)....done
## The input is identified as the covariance matrix.
## Conducting Meinshausen &amp; Buhlmann graph estimation (mb)....done
## The input is identified as the covariance matrix.
## Conducting Meinshausen &amp; Buhlmann graph estimation (mb)....done
## The input is identified as the covariance matrix.
## Conducting Meinshausen &amp; Buhlmann graph estimation (mb)....done
## The input is identified as the covariance matrix.
## Conducting Meinshausen &amp; Buhlmann graph estimation (mb)....done
## The input is identified as the covariance matrix.
## Conducting Meinshausen &amp; Buhlmann graph estimation (mb)....done
## The input is identified as the covariance matrix.
## Conducting Meinshausen &amp; Buhlmann graph estimation (mb)....done
## The input is identified as the covariance matrix.
## Conducting Meinshausen &amp; Buhlmann graph estimation (mb)....done
## The input is identified as the covariance matrix.
## Conducting Meinshausen &amp; Buhlmann graph estimation (mb)....done</code></pre>
<pre><code>## Done.</code></pre>
</div>
<div id="analyzing-the-constructed-network" class="section level4 hasAnchor">
<h4><span class="header-section-number">4.5.1.2</span> Analyzing the constructed network<a href="network-analysis-1.html#analyzing-the-constructed-network" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="network-analysis-1.html#cb165-1"></a>props_single &lt;-<span class="st"> </span><span class="kw">netAnalyze</span>(net_single, </span>
<span id="cb165-2"><a href="network-analysis-1.html#cb165-2"></a>                           <span class="dt">centrLCC =</span> <span class="ot">TRUE</span>,</span>
<span id="cb165-3"><a href="network-analysis-1.html#cb165-3"></a>                           <span class="dt">clustMethod =</span> <span class="st">&quot;cluster_fast_greedy&quot;</span>,</span>
<span id="cb165-4"><a href="network-analysis-1.html#cb165-4"></a>                           <span class="dt">hubPar =</span> <span class="st">&quot;eigenvector&quot;</span>,</span>
<span id="cb165-5"><a href="network-analysis-1.html#cb165-5"></a>                           <span class="dt">weightDeg =</span> <span class="ot">FALSE</span>, </span>
<span id="cb165-6"><a href="network-analysis-1.html#cb165-6"></a>                           <span class="dt">normDeg =</span> <span class="ot">FALSE</span>)</span>
<span id="cb165-7"><a href="network-analysis-1.html#cb165-7"></a></span>
<span id="cb165-8"><a href="network-analysis-1.html#cb165-8"></a><span class="co">#?summary.microNetProps</span></span>
<span id="cb165-9"><a href="network-analysis-1.html#cb165-9"></a><span class="kw">summary</span>(props_single, <span class="dt">numbNodes =</span> 5L)</span></code></pre></div>
<pre><code>## 
## Component sizes
## ```````````````               
## size: 24 3 2  1
##    #:  1 1 1 19
## ______________________________
## Global network properties
## `````````````````````````
## Largest connected component (LCC):
##                                  
## Relative LCC size         0.50000
## Clustering coefficient    0.13809
## Modularity                0.61719
## Positive edge percentage 87.50000
## Edge density              0.08696
## Natural connectivity      0.05294
## Vertex connectivity       1.00000
## Edge connectivity         1.00000
## Average dissimilarity*    0.97231
## Average path length**     4.17479
## 
## Whole network:
##                                  
## Number of components     22.00000
## Clustering coefficient    0.13042
## Modularity                0.67421
## Positive edge percentage 88.88889
## Edge density              0.02394
## Natural connectivity      0.02400
## 
##  *Dissimilarity = 1 - edge weight
## **Path length: Units with average dissimilarity
## 
## ______________________________
## Clusters
## - In the whole network
## - Algorithm: cluster_fast_greedy
## ```````````````````````````````` 
##                       
## name:  0 1 2 3 4 5 6 7
##    #: 19 7 6 5 3 3 2 3
## 
## ______________________________
## Hubs
## - In alphabetical/numerical order
## - Based on empirical quantiles of centralities
## ```````````````````````````````````````````````        
##  M_42398
##  M_52447
##  M_52464
## 
## ______________________________
## Centrality measures
## - In decreasing order
## - Centrality of disconnected components is zero
## ````````````````````````````````````````````````
## Degree (unnormalized):
##          
## M_36600 4
## M_42398 4
## M_52603 3
## M_52447 3
## M_19266 3
## 
## Betweenness centrality (normalized):
##                
## M_19266 0.56126
## M_42398 0.55731
## M_42450 0.52174
## M_52462 0.51383
## M_39270 0.49802
## 
## Closeness centrality (normalized):
##                
## M_42398 0.55454
## M_36600 0.49039
## M_19266 0.48425
## M_39270 0.48005
## M_52447 0.47460
## 
## Eigenvector centrality (normalized):
##                
## M_52447 1.00000
## M_42398 0.79014
## M_52464 0.78767
## M_55041 0.78469
## M_35631 0.37519</code></pre>
</div>
<div id="visualizing-the-network" class="section level4 hasAnchor">
<h4><span class="header-section-number">4.5.1.3</span> Visualizing the network<a href="network-analysis-1.html#visualizing-the-network" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="network-analysis-1.html#cb167-1"></a><span class="kw">plot</span>(props_single, </span>
<span id="cb167-2"><a href="network-analysis-1.html#cb167-2"></a>     <span class="dt">nodeColor =</span> <span class="st">&quot;cluster&quot;</span>, </span>
<span id="cb167-3"><a href="network-analysis-1.html#cb167-3"></a>     <span class="dt">nodeSize =</span> <span class="st">&quot;eigenvector&quot;</span>,</span>
<span id="cb167-4"><a href="network-analysis-1.html#cb167-4"></a>     <span class="dt">title1 =</span> <span class="st">&quot;Network on metabolomics with SPRING associations&quot;</span>, </span>
<span id="cb167-5"><a href="network-analysis-1.html#cb167-5"></a>     <span class="dt">showTitle =</span> <span class="ot">TRUE</span>,</span>
<span id="cb167-6"><a href="network-analysis-1.html#cb167-6"></a>     <span class="dt">cexTitle =</span> <span class="fl">1.5</span>)</span>
<span id="cb167-7"><a href="network-analysis-1.html#cb167-7"></a></span>
<span id="cb167-8"><a href="network-analysis-1.html#cb167-8"></a><span class="kw">legend</span>(<span class="fl">0.7</span>, <span class="fl">1.1</span>, <span class="dt">cex =</span> <span class="fl">0.8</span>, <span class="dt">title =</span> <span class="st">&quot;estimated association:&quot;</span>,</span>
<span id="cb167-9"><a href="network-analysis-1.html#cb167-9"></a>       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;+&quot;</span>,<span class="st">&quot;-&quot;</span>), <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;#009900&quot;</span>,<span class="st">&quot;red&quot;</span>), </span>
<span id="cb167-10"><a href="network-analysis-1.html#cb167-10"></a>       <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">horiz =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="OMics-analysis-workflow_files/figure-html/unnamed-chunk-110-1.png" width="768" /></p>
<p>Note that edge weights are (non-negative) similarities, however, the edges belonging to negative estimated associations are colored in red by default (negDiffCol = TRUE).</p>
</div>
</div>
<div id="single-network-with-pearson-correlation-as-association-measure" class="section level3 hasAnchor">
<h3><span class="header-section-number">4.5.2</span> Single network with Pearson correlation as association measure<a href="network-analysis-1.html#single-network-with-pearson-correlation-as-association-measure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Since Pearson correlations may lead to compositional effects when applied to sequencing data, we use the clr transformation as normalization method. Zero treatment is necessary in this case.</p>
<p>A threshold of 0.3 is used as sparsification method, so that only OTUs with an absolute correlation greater than or equal to 0.3 are connected.</p>
<div id="building-network-model-1" class="section level4 hasAnchor">
<h4><span class="header-section-number">4.5.2.1</span> Building network model<a href="network-analysis-1.html#building-network-model-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="network-analysis-1.html#cb168-1"></a>net_single2 &lt;-<span class="st"> </span><span class="kw">netConstruct</span>(features_tab,  </span>
<span id="cb168-2"><a href="network-analysis-1.html#cb168-2"></a>                            <span class="dt">measure =</span> <span class="st">&quot;pearson&quot;</span>,</span>
<span id="cb168-3"><a href="network-analysis-1.html#cb168-3"></a>                            <span class="dt">normMethod =</span> <span class="st">&quot;clr&quot;</span>, </span>
<span id="cb168-4"><a href="network-analysis-1.html#cb168-4"></a>                            <span class="dt">zeroMethod =</span> <span class="st">&quot;multRepl&quot;</span>,</span>
<span id="cb168-5"><a href="network-analysis-1.html#cb168-5"></a>                            <span class="dt">sparsMethod =</span> <span class="st">&quot;threshold&quot;</span>, </span>
<span id="cb168-6"><a href="network-analysis-1.html#cb168-6"></a>                            <span class="dt">thresh =</span> <span class="fl">0.3</span>,</span>
<span id="cb168-7"><a href="network-analysis-1.html#cb168-7"></a>                            <span class="dt">verbose =</span> <span class="dv">3</span>,</span>
<span id="cb168-8"><a href="network-analysis-1.html#cb168-8"></a>                            <span class="dt">seed =</span> <span class="dv">123</span>)</span></code></pre></div>
<pre><code>## 48 taxa and 45 samples remaining.</code></pre>
<pre><code>## 
## Zero treatment:</code></pre>
<pre><code>## Execute multRepl() ... Done.
## 
## Normalization:
## Execute clr(){SpiecEasi} ... Done.
## 
## Calculate &#39;pearson&#39; associations ... Done.
## 
## Sparsify associations via &#39;threshold&#39; ... Done.</code></pre>
</div>
<div id="visualizing-the-network-1" class="section level4 hasAnchor">
<h4><span class="header-section-number">4.5.2.2</span> Visualizing the network<a href="network-analysis-1.html#visualizing-the-network-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>primary plot</li>
</ul>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="network-analysis-1.html#cb172-1"></a>props_single2 &lt;-<span class="st"> </span><span class="kw">netAnalyze</span>(net_single2, <span class="dt">clustMethod =</span> <span class="st">&quot;cluster_fast_greedy&quot;</span>)</span>
<span id="cb172-2"><a href="network-analysis-1.html#cb172-2"></a></span>
<span id="cb172-3"><a href="network-analysis-1.html#cb172-3"></a><span class="kw">plot</span>(props_single2, </span>
<span id="cb172-4"><a href="network-analysis-1.html#cb172-4"></a>     <span class="dt">nodeColor =</span> <span class="st">&quot;cluster&quot;</span>, </span>
<span id="cb172-5"><a href="network-analysis-1.html#cb172-5"></a>     <span class="dt">nodeSize =</span> <span class="st">&quot;eigenvector&quot;</span>,</span>
<span id="cb172-6"><a href="network-analysis-1.html#cb172-6"></a>     <span class="dt">title1 =</span> <span class="st">&quot;Network on metabolomics with Pearson correlations&quot;</span>, </span>
<span id="cb172-7"><a href="network-analysis-1.html#cb172-7"></a>     <span class="dt">showTitle =</span> <span class="ot">TRUE</span>,</span>
<span id="cb172-8"><a href="network-analysis-1.html#cb172-8"></a>     <span class="dt">cexTitle =</span> <span class="fl">1.5</span>)</span>
<span id="cb172-9"><a href="network-analysis-1.html#cb172-9"></a></span>
<span id="cb172-10"><a href="network-analysis-1.html#cb172-10"></a><span class="kw">legend</span>(<span class="fl">0.7</span>, <span class="fl">1.1</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">title =</span> <span class="st">&quot;estimated correlation:&quot;</span>, </span>
<span id="cb172-11"><a href="network-analysis-1.html#cb172-11"></a>       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;+&quot;</span>,<span class="st">&quot;-&quot;</span>), <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;#009900&quot;</span>,<span class="st">&quot;red&quot;</span>), </span>
<span id="cb172-12"><a href="network-analysis-1.html#cb172-12"></a>       <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">horiz =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="OMics-analysis-workflow_files/figure-html/unnamed-chunk-112-1.png" width="768" /></p>
<ul>
<li><p>improve the visualization by changing the following arguments:</p>
<ul>
<li><p><code>repulsion = 0.8</code>: Place the nodes further apart</p></li>
<li><p><code>rmSingles = TRUE</code>: Single nodes are removed</p></li>
<li><p><code>labelScale = FALSE</code> and <code>cexLabels = 1.6</code>: All labels have equal size and are enlarged to improve readability of small node’s labels</p></li>
<li><p><code>nodeSizeSpread = 3</code> (default is 4): Node sizes are more similar if the value is decreased. This argument (in combination with <code>cexNodes</code>) is useful to enlarge small nodes while keeping the size of big nodes.</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="network-analysis-1.html#cb173-1"></a><span class="kw">plot</span>(props_single2, </span>
<span id="cb173-2"><a href="network-analysis-1.html#cb173-2"></a>     <span class="dt">nodeColor =</span> <span class="st">&quot;cluster&quot;</span>, </span>
<span id="cb173-3"><a href="network-analysis-1.html#cb173-3"></a>     <span class="dt">nodeSize =</span> <span class="st">&quot;eigenvector&quot;</span>,</span>
<span id="cb173-4"><a href="network-analysis-1.html#cb173-4"></a>     <span class="dt">repulsion =</span> <span class="fl">0.8</span>,</span>
<span id="cb173-5"><a href="network-analysis-1.html#cb173-5"></a>     <span class="dt">rmSingles =</span> <span class="ot">TRUE</span>,</span>
<span id="cb173-6"><a href="network-analysis-1.html#cb173-6"></a>     <span class="dt">labelScale =</span> <span class="ot">FALSE</span>,</span>
<span id="cb173-7"><a href="network-analysis-1.html#cb173-7"></a>     <span class="dt">cexLabels =</span> <span class="fl">1.6</span>,</span>
<span id="cb173-8"><a href="network-analysis-1.html#cb173-8"></a>     <span class="dt">nodeSizeSpread =</span> <span class="dv">3</span>,</span>
<span id="cb173-9"><a href="network-analysis-1.html#cb173-9"></a>     <span class="dt">cexNodes =</span> <span class="dv">2</span>,</span>
<span id="cb173-10"><a href="network-analysis-1.html#cb173-10"></a>     <span class="dt">title1 =</span> <span class="st">&quot;Network on metabolomics with Pearson correlations&quot;</span>, </span>
<span id="cb173-11"><a href="network-analysis-1.html#cb173-11"></a>     <span class="dt">showTitle =</span> <span class="ot">TRUE</span>,</span>
<span id="cb173-12"><a href="network-analysis-1.html#cb173-12"></a>     <span class="dt">cexTitle =</span> <span class="fl">1.5</span>)</span>
<span id="cb173-13"><a href="network-analysis-1.html#cb173-13"></a></span>
<span id="cb173-14"><a href="network-analysis-1.html#cb173-14"></a><span class="kw">legend</span>(<span class="fl">0.7</span>, <span class="fl">1.1</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>, <span class="dt">title =</span> <span class="st">&quot;estimated correlation:&quot;</span>,</span>
<span id="cb173-15"><a href="network-analysis-1.html#cb173-15"></a>       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;+&quot;</span>,<span class="st">&quot;-&quot;</span>), <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;#009900&quot;</span>,<span class="st">&quot;red&quot;</span>),</span>
<span id="cb173-16"><a href="network-analysis-1.html#cb173-16"></a>       <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">horiz =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="OMics-analysis-workflow_files/figure-html/unnamed-chunk-113-1.png" width="1152" /></p>
</div>
</div>
<div id="single-network-with-spieceasi-correlation-as-association-measure" class="section level3 hasAnchor">
<h3><span class="header-section-number">4.5.3</span> Single network with SpiecEasi correlation as association measure<a href="network-analysis-1.html#single-network-with-spieceasi-correlation-as-association-measure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Only the 50 features with highest variance are selected.</p></li>
<li><p>Only samples with a total number of reads of at least 100 included.</p></li>
</ul>
<div id="building-network-model-2" class="section level4 hasAnchor">
<h4><span class="header-section-number">4.5.3.1</span> Building network model<a href="network-analysis-1.html#building-network-model-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="network-analysis-1.html#cb174-1"></a>net_single3 &lt;-<span class="st"> </span><span class="kw">netConstruct</span>(features_tab, </span>
<span id="cb174-2"><a href="network-analysis-1.html#cb174-2"></a>                            <span class="dt">measure =</span> <span class="st">&quot;spieceasi&quot;</span>,</span>
<span id="cb174-3"><a href="network-analysis-1.html#cb174-3"></a>                            <span class="dt">measurePar =</span> <span class="kw">list</span>(<span class="dt">method =</span> <span class="st">&quot;mb&quot;</span>,</span>
<span id="cb174-4"><a href="network-analysis-1.html#cb174-4"></a>                                              <span class="dt">pulsar.params =</span> <span class="kw">list</span>(<span class="dt">rep.num =</span> <span class="dv">10</span>),</span>
<span id="cb174-5"><a href="network-analysis-1.html#cb174-5"></a>                                              <span class="dt">symBetaMode =</span> <span class="st">&quot;ave&quot;</span>),</span>
<span id="cb174-6"><a href="network-analysis-1.html#cb174-6"></a>                            <span class="dt">filtTax =</span> <span class="st">&quot;highestVar&quot;</span>,</span>
<span id="cb174-7"><a href="network-analysis-1.html#cb174-7"></a>                            <span class="dt">filtTaxPar =</span> <span class="kw">list</span>(<span class="dt">highestVar =</span> <span class="dv">50</span>),</span>
<span id="cb174-8"><a href="network-analysis-1.html#cb174-8"></a>                            <span class="dt">filtSamp =</span> <span class="st">&quot;totalReads&quot;</span>,</span>
<span id="cb174-9"><a href="network-analysis-1.html#cb174-9"></a>                            <span class="dt">filtSampPar =</span> <span class="kw">list</span>(<span class="dt">totalReads =</span> <span class="dv">100</span>),</span>
<span id="cb174-10"><a href="network-analysis-1.html#cb174-10"></a>                            <span class="dt">verbose =</span> <span class="dv">3</span>,</span>
<span id="cb174-11"><a href="network-analysis-1.html#cb174-11"></a>                            <span class="dt">seed =</span> <span class="dv">123</span>)</span></code></pre></div>
<pre><code>## Infos about changed arguments:</code></pre>
<pre><code>## Sparsification included in &#39;spieceasi&#39;.</code></pre>
<pre><code>## Data filtering ...</code></pre>
<pre><code>## 48 taxa and 45 samples remaining.</code></pre>
<pre><code>## 
## Calculate &#39;spieceasi&#39; associations ... 
## Applying data transformations...
## Selecting model with pulsar using stars...
## Fitting final estimate with mb...
## done
## Done.</code></pre>
</div>
<div id="visualizing-the-network-2" class="section level4 hasAnchor">
<h4><span class="header-section-number">4.5.3.2</span> Visualizing the network<a href="network-analysis-1.html#visualizing-the-network-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="network-analysis-1.html#cb180-1"></a>props_single3 &lt;-<span class="st"> </span><span class="kw">netAnalyze</span>(net_single3, <span class="dt">clustMethod =</span> <span class="st">&quot;cluster_fast_greedy&quot;</span>)</span>
<span id="cb180-2"><a href="network-analysis-1.html#cb180-2"></a></span>
<span id="cb180-3"><a href="network-analysis-1.html#cb180-3"></a><span class="kw">plot</span>(props_single3, </span>
<span id="cb180-4"><a href="network-analysis-1.html#cb180-4"></a>     <span class="dt">nodeColor =</span> <span class="st">&quot;cluster&quot;</span>, </span>
<span id="cb180-5"><a href="network-analysis-1.html#cb180-5"></a>     <span class="dt">nodeSize =</span> <span class="st">&quot;eigenvector&quot;</span>,</span>
<span id="cb180-6"><a href="network-analysis-1.html#cb180-6"></a>     <span class="dt">repulsion =</span> <span class="fl">0.8</span>,</span>
<span id="cb180-7"><a href="network-analysis-1.html#cb180-7"></a>     <span class="dt">rmSingles =</span> <span class="ot">TRUE</span>,</span>
<span id="cb180-8"><a href="network-analysis-1.html#cb180-8"></a>     <span class="dt">labelScale =</span> <span class="ot">FALSE</span>,</span>
<span id="cb180-9"><a href="network-analysis-1.html#cb180-9"></a>     <span class="dt">cexLabels =</span> <span class="fl">1.6</span>,</span>
<span id="cb180-10"><a href="network-analysis-1.html#cb180-10"></a>     <span class="dt">nodeSizeSpread =</span> <span class="dv">3</span>,</span>
<span id="cb180-11"><a href="network-analysis-1.html#cb180-11"></a>     <span class="dt">cexNodes =</span> <span class="dv">2</span>,</span>
<span id="cb180-12"><a href="network-analysis-1.html#cb180-12"></a>     <span class="dt">title1 =</span> <span class="st">&quot;Network on metabolomics with SpiecEasi correlations&quot;</span>, </span>
<span id="cb180-13"><a href="network-analysis-1.html#cb180-13"></a>     <span class="dt">showTitle =</span> <span class="ot">TRUE</span>,</span>
<span id="cb180-14"><a href="network-analysis-1.html#cb180-14"></a>     <span class="dt">cexTitle =</span> <span class="fl">1.5</span>)</span>
<span id="cb180-15"><a href="network-analysis-1.html#cb180-15"></a></span>
<span id="cb180-16"><a href="network-analysis-1.html#cb180-16"></a><span class="kw">legend</span>(<span class="fl">0.7</span>, <span class="fl">1.1</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>, <span class="dt">title =</span> <span class="st">&quot;estimated correlation:&quot;</span>,</span>
<span id="cb180-17"><a href="network-analysis-1.html#cb180-17"></a>       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;+&quot;</span>,<span class="st">&quot;-&quot;</span>), <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;#009900&quot;</span>,<span class="st">&quot;red&quot;</span>),</span>
<span id="cb180-18"><a href="network-analysis-1.html#cb180-18"></a>       <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">horiz =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="OMics-analysis-workflow_files/figure-html/unnamed-chunk-115-1.png" width="1152" /></p>
</div>
</div>
<div id="single-network-with-wgcna-bicor-as-association-measure" class="section level3 hasAnchor">
<h3><span class="header-section-number">4.5.4</span> Single network with WGCNA (bicor) as association measure<a href="network-analysis-1.html#single-network-with-wgcna-bicor-as-association-measure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Biweight Midcorrelation <code>bicor()</code> from WGCNA package.</p>
<div id="building-network-model-3" class="section level4 hasAnchor">
<h4><span class="header-section-number">4.5.4.1</span> Building network model<a href="network-analysis-1.html#building-network-model-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="network-analysis-1.html#cb181-1"></a>net_single4 &lt;-<span class="st"> </span><span class="kw">netConstruct</span>(features_tab, </span>
<span id="cb181-2"><a href="network-analysis-1.html#cb181-2"></a>                           <span class="dt">measure =</span> <span class="st">&quot;bicor&quot;</span>,</span>
<span id="cb181-3"><a href="network-analysis-1.html#cb181-3"></a>                           <span class="dt">measurePar =</span> <span class="kw">list</span>(<span class="dt">use =</span> <span class="st">&quot;all.obs&quot;</span>,</span>
<span id="cb181-4"><a href="network-analysis-1.html#cb181-4"></a>                                             <span class="dt">maxPOutliers =</span> <span class="dv">1</span>,</span>
<span id="cb181-5"><a href="network-analysis-1.html#cb181-5"></a>                                             <span class="dt">nThreads =</span> <span class="dv">2</span>),</span>
<span id="cb181-6"><a href="network-analysis-1.html#cb181-6"></a>                           <span class="dt">filtTax =</span> <span class="st">&quot;highestVar&quot;</span>,</span>
<span id="cb181-7"><a href="network-analysis-1.html#cb181-7"></a>                           <span class="dt">filtTaxPar =</span> <span class="kw">list</span>(<span class="dt">highestVar =</span> <span class="dv">50</span>),</span>
<span id="cb181-8"><a href="network-analysis-1.html#cb181-8"></a>                           <span class="dt">filtSamp =</span> <span class="st">&quot;totalReads&quot;</span>,</span>
<span id="cb181-9"><a href="network-analysis-1.html#cb181-9"></a>                           <span class="dt">filtSampPar =</span> <span class="kw">list</span>(<span class="dt">totalReads =</span> <span class="dv">100</span>),</span>
<span id="cb181-10"><a href="network-analysis-1.html#cb181-10"></a>                           <span class="dt">dissFunc =</span> <span class="st">&quot;TOMdiss&quot;</span>,</span>
<span id="cb181-11"><a href="network-analysis-1.html#cb181-11"></a>                           <span class="dt">verbose =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Attention! The chosen combination of association measure
## and normalization is not robust to compositional effects.</code></pre>
<pre><code>## Data filtering ...</code></pre>
<pre><code>## 48 taxa and 45 samples remaining.</code></pre>
<pre><code>## 
## Calculate &#39;bicor&#39; associations ...</code></pre>
<pre><code>## ..will use 2 parallel threads.
##  Fraction of slow calculations: 0.000000</code></pre>
<pre><code>## Done.
## 
## Sparsify associations via &#39;t-test&#39; ... 
## Adjust for multiple testing via &#39;adaptBH&#39; ... 
##  Proportion of true null hypotheses: 0.43
## Done.
## Done.</code></pre>
</div>
<div id="visualizing-the-network-3" class="section level4 hasAnchor">
<h4><span class="header-section-number">4.5.4.2</span> Visualizing the network<a href="network-analysis-1.html#visualizing-the-network-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="network-analysis-1.html#cb188-1"></a>props_single4 &lt;-<span class="st"> </span><span class="kw">netAnalyze</span>(net_single4, <span class="dt">clustMethod =</span> <span class="st">&quot;cluster_fast_greedy&quot;</span>)</span>
<span id="cb188-2"><a href="network-analysis-1.html#cb188-2"></a></span>
<span id="cb188-3"><a href="network-analysis-1.html#cb188-3"></a><span class="kw">plot</span>(props_single4, </span>
<span id="cb188-4"><a href="network-analysis-1.html#cb188-4"></a>     <span class="dt">nodeColor =</span> <span class="st">&quot;cluster&quot;</span>, </span>
<span id="cb188-5"><a href="network-analysis-1.html#cb188-5"></a>     <span class="dt">nodeSize =</span> <span class="st">&quot;eigenvector&quot;</span>,</span>
<span id="cb188-6"><a href="network-analysis-1.html#cb188-6"></a>     <span class="dt">repulsion =</span> <span class="fl">0.8</span>,</span>
<span id="cb188-7"><a href="network-analysis-1.html#cb188-7"></a>     <span class="dt">rmSingles =</span> <span class="ot">TRUE</span>,</span>
<span id="cb188-8"><a href="network-analysis-1.html#cb188-8"></a>     <span class="dt">labelScale =</span> <span class="ot">FALSE</span>,</span>
<span id="cb188-9"><a href="network-analysis-1.html#cb188-9"></a>     <span class="dt">cexLabels =</span> <span class="fl">1.6</span>,</span>
<span id="cb188-10"><a href="network-analysis-1.html#cb188-10"></a>     <span class="dt">nodeSizeSpread =</span> <span class="dv">3</span>,</span>
<span id="cb188-11"><a href="network-analysis-1.html#cb188-11"></a>     <span class="dt">cexNodes =</span> <span class="dv">2</span>,</span>
<span id="cb188-12"><a href="network-analysis-1.html#cb188-12"></a>     <span class="dt">title1 =</span> <span class="st">&quot;Network on metabolomics with WGCNA correlations&quot;</span>, </span>
<span id="cb188-13"><a href="network-analysis-1.html#cb188-13"></a>     <span class="dt">showTitle =</span> <span class="ot">TRUE</span>,</span>
<span id="cb188-14"><a href="network-analysis-1.html#cb188-14"></a>     <span class="dt">cexTitle =</span> <span class="fl">1.5</span>)</span>
<span id="cb188-15"><a href="network-analysis-1.html#cb188-15"></a></span>
<span id="cb188-16"><a href="network-analysis-1.html#cb188-16"></a><span class="kw">legend</span>(<span class="fl">0.7</span>, <span class="fl">1.1</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>, <span class="dt">title =</span> <span class="st">&quot;estimated correlation:&quot;</span>,</span>
<span id="cb188-17"><a href="network-analysis-1.html#cb188-17"></a>       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;+&quot;</span>,<span class="st">&quot;-&quot;</span>), <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;#009900&quot;</span>,<span class="st">&quot;red&quot;</span>),</span>
<span id="cb188-18"><a href="network-analysis-1.html#cb188-18"></a>       <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">horiz =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="OMics-analysis-workflow_files/figure-html/unnamed-chunk-117-1.png" width="1152" /></p>
</div>
</div>
<div id="single-network-with-sparcc-correlation-as-association-measure" class="section level3 hasAnchor">
<h3><span class="header-section-number">4.5.5</span> Single network with sparcc correlation as association measure<a href="network-analysis-1.html#single-network-with-sparcc-correlation-as-association-measure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Only the 40 features with highest variance are selected.</p></li>
<li><p>Only samples with a total number of reads of at least 100 included.</p></li>
</ul>
<div id="building-network-model-4" class="section level4 hasAnchor">
<h4><span class="header-section-number">4.5.5.1</span> Building network model<a href="network-analysis-1.html#building-network-model-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="network-analysis-1.html#cb189-1"></a>net_single5 &lt;-<span class="st"> </span><span class="kw">netConstruct</span>(features_tab, </span>
<span id="cb189-2"><a href="network-analysis-1.html#cb189-2"></a>                           <span class="dt">measure =</span> <span class="st">&quot;sparcc&quot;</span>,</span>
<span id="cb189-3"><a href="network-analysis-1.html#cb189-3"></a>                           <span class="dt">measurePar =</span> <span class="kw">list</span>(<span class="dt">iter =</span> <span class="dv">20</span>,</span>
<span id="cb189-4"><a href="network-analysis-1.html#cb189-4"></a>                                             <span class="dt">inner_iter =</span> <span class="dv">10</span>,</span>
<span id="cb189-5"><a href="network-analysis-1.html#cb189-5"></a>                                             <span class="dt">th =</span> <span class="fl">0.1</span>),</span>
<span id="cb189-6"><a href="network-analysis-1.html#cb189-6"></a>                           <span class="dt">filtTax =</span> <span class="st">&quot;highestVar&quot;</span>,</span>
<span id="cb189-7"><a href="network-analysis-1.html#cb189-7"></a>                           <span class="dt">filtTaxPar =</span> <span class="kw">list</span>(<span class="dt">highestVar =</span> <span class="dv">50</span>),</span>
<span id="cb189-8"><a href="network-analysis-1.html#cb189-8"></a>                           <span class="dt">filtSamp =</span> <span class="st">&quot;totalReads&quot;</span>,</span>
<span id="cb189-9"><a href="network-analysis-1.html#cb189-9"></a>                           <span class="dt">filtSampPar =</span> <span class="kw">list</span>(<span class="dt">totalReads =</span> <span class="dv">100</span>),</span>
<span id="cb189-10"><a href="network-analysis-1.html#cb189-10"></a>                           <span class="dt">verbose =</span> <span class="dv">3</span>,</span>
<span id="cb189-11"><a href="network-analysis-1.html#cb189-11"></a>                           <span class="dt">seed =</span> <span class="dv">123</span>)</span></code></pre></div>
<pre><code>## Data filtering ...</code></pre>
<pre><code>## 48 taxa and 45 samples remaining.</code></pre>
<pre><code>## 
## Calculate &#39;sparcc&#39; associations ... Done.
## 
## Sparsify associations via &#39;t-test&#39; ... 
## Adjust for multiple testing via &#39;adaptBH&#39; ... 
##  Proportion of true null hypotheses: 0.37
## Done.
## Done.</code></pre>
</div>
<div id="visualizing-the-network-4" class="section level4 hasAnchor">
<h4><span class="header-section-number">4.5.5.2</span> Visualizing the network<a href="network-analysis-1.html#visualizing-the-network-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="network-analysis-1.html#cb193-1"></a>props_single5 &lt;-<span class="st"> </span><span class="kw">netAnalyze</span>(net_single5, <span class="dt">clustMethod =</span> <span class="st">&quot;cluster_fast_greedy&quot;</span>)</span>
<span id="cb193-2"><a href="network-analysis-1.html#cb193-2"></a></span>
<span id="cb193-3"><a href="network-analysis-1.html#cb193-3"></a><span class="kw">plot</span>(props_single5, </span>
<span id="cb193-4"><a href="network-analysis-1.html#cb193-4"></a>     <span class="dt">nodeColor =</span> <span class="st">&quot;cluster&quot;</span>, </span>
<span id="cb193-5"><a href="network-analysis-1.html#cb193-5"></a>     <span class="dt">nodeSize =</span> <span class="st">&quot;eigenvector&quot;</span>,</span>
<span id="cb193-6"><a href="network-analysis-1.html#cb193-6"></a>     <span class="dt">repulsion =</span> <span class="fl">0.8</span>,</span>
<span id="cb193-7"><a href="network-analysis-1.html#cb193-7"></a>     <span class="dt">rmSingles =</span> <span class="ot">TRUE</span>,</span>
<span id="cb193-8"><a href="network-analysis-1.html#cb193-8"></a>     <span class="dt">labelScale =</span> <span class="ot">FALSE</span>,</span>
<span id="cb193-9"><a href="network-analysis-1.html#cb193-9"></a>     <span class="dt">cexLabels =</span> <span class="fl">1.6</span>,</span>
<span id="cb193-10"><a href="network-analysis-1.html#cb193-10"></a>     <span class="dt">nodeSizeSpread =</span> <span class="dv">3</span>,</span>
<span id="cb193-11"><a href="network-analysis-1.html#cb193-11"></a>     <span class="dt">cexNodes =</span> <span class="dv">2</span>,</span>
<span id="cb193-12"><a href="network-analysis-1.html#cb193-12"></a>     <span class="dt">title1 =</span> <span class="st">&quot;Network on metabolomics with sparcc correlations&quot;</span>, </span>
<span id="cb193-13"><a href="network-analysis-1.html#cb193-13"></a>     <span class="dt">showTitle =</span> <span class="ot">TRUE</span>,</span>
<span id="cb193-14"><a href="network-analysis-1.html#cb193-14"></a>     <span class="dt">cexTitle =</span> <span class="fl">1.5</span>)</span>
<span id="cb193-15"><a href="network-analysis-1.html#cb193-15"></a></span>
<span id="cb193-16"><a href="network-analysis-1.html#cb193-16"></a><span class="kw">legend</span>(<span class="fl">0.7</span>, <span class="fl">1.1</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>, <span class="dt">title =</span> <span class="st">&quot;estimated correlation:&quot;</span>,</span>
<span id="cb193-17"><a href="network-analysis-1.html#cb193-17"></a>       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;+&quot;</span>,<span class="st">&quot;-&quot;</span>), <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;#009900&quot;</span>,<span class="st">&quot;red&quot;</span>),</span>
<span id="cb193-18"><a href="network-analysis-1.html#cb193-18"></a>       <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">horiz =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="OMics-analysis-workflow_files/figure-html/unnamed-chunk-119-1.png" width="1152" /></p>
</div>
</div>
</div>
<div id="dissimilarity-based-networks" class="section level2 hasAnchor">
<h2><span class="header-section-number">4.6</span> Dissimilarity-based Networks<a href="network-analysis-1.html#dissimilarity-based-networks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>If a dissimilarity measure is used for network construction, nodes are subjects instead of OTUs. The estimated dissimilarities are transformed into similarities, which are used as edge weights so that subjects with a similar microbial composition are placed close together in the network plot.</p>
</blockquote>
<blockquote>
<p>We construct a single network using Aitchison’s distance being suitable for the application on compositional data.</p>
</blockquote>
<blockquote>
<p>Since the Aitchison distance is based on the clr-transformation, zeros in the data need to be replaced.</p>
</blockquote>
<blockquote>
<p>The network is sparsified using the k-nearest neighbor (knn) algorithm.</p>
</blockquote>
<div id="building-network-module" class="section level3 hasAnchor">
<h3><span class="header-section-number">4.6.1</span> Building network module<a href="network-analysis-1.html#building-network-module" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="network-analysis-1.html#cb194-1"></a>net_aitchison &lt;-<span class="st"> </span><span class="kw">netConstruct</span>(features_tab,</span>
<span id="cb194-2"><a href="network-analysis-1.html#cb194-2"></a>                              <span class="dt">measure =</span> <span class="st">&quot;aitchison&quot;</span>,</span>
<span id="cb194-3"><a href="network-analysis-1.html#cb194-3"></a>                              <span class="dt">zeroMethod =</span> <span class="st">&quot;multRepl&quot;</span>,</span>
<span id="cb194-4"><a href="network-analysis-1.html#cb194-4"></a>                              <span class="dt">sparsMethod =</span> <span class="st">&quot;knn&quot;</span>, </span>
<span id="cb194-5"><a href="network-analysis-1.html#cb194-5"></a>                              <span class="dt">kNeighbor =</span> <span class="dv">3</span>,</span>
<span id="cb194-6"><a href="network-analysis-1.html#cb194-6"></a>                              <span class="dt">verbose =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Infos about changed arguments:</code></pre>
<pre><code>## Counts normalized to fractions for measure &#39;aitchison&#39;.</code></pre>
<pre><code>## 48 taxa and 45 samples remaining.</code></pre>
<pre><code>## 
## Zero treatment:</code></pre>
<pre><code>## Execute multRepl() ... Done.
## 
## Normalization:
## Counts normalized by total sum scaling.
## 
## Calculate &#39;aitchison&#39; dissimilarities ... Done.
## 
## Sparsify dissimilarities via &#39;knn&#39; ... Done.</code></pre>
</div>
<div id="visualizing-the-network-5" class="section level3 hasAnchor">
<h3><span class="header-section-number">4.6.2</span> Visualizing the network<a href="network-analysis-1.html#visualizing-the-network-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="network-analysis-1.html#cb200-1"></a>props_aitchison &lt;-<span class="st"> </span><span class="kw">netAnalyze</span>(net_aitchison,</span>
<span id="cb200-2"><a href="network-analysis-1.html#cb200-2"></a>                              <span class="dt">clustMethod =</span> <span class="st">&quot;hierarchical&quot;</span>,</span>
<span id="cb200-3"><a href="network-analysis-1.html#cb200-3"></a>                              <span class="dt">clustPar =</span> <span class="kw">list</span>(<span class="dt">method =</span> <span class="st">&quot;average&quot;</span>, <span class="dt">k =</span> <span class="dv">3</span>),</span>
<span id="cb200-4"><a href="network-analysis-1.html#cb200-4"></a>                              <span class="dt">hubPar =</span> <span class="st">&quot;eigenvector&quot;</span>)</span>
<span id="cb200-5"><a href="network-analysis-1.html#cb200-5"></a></span>
<span id="cb200-6"><a href="network-analysis-1.html#cb200-6"></a><span class="kw">plot</span>(props_aitchison, </span>
<span id="cb200-7"><a href="network-analysis-1.html#cb200-7"></a>     <span class="dt">nodeColor =</span> <span class="st">&quot;cluster&quot;</span>, </span>
<span id="cb200-8"><a href="network-analysis-1.html#cb200-8"></a>     <span class="dt">nodeSize =</span> <span class="st">&quot;eigenvector&quot;</span>,</span>
<span id="cb200-9"><a href="network-analysis-1.html#cb200-9"></a>     <span class="dt">repulsion =</span> <span class="fl">0.8</span>,</span>
<span id="cb200-10"><a href="network-analysis-1.html#cb200-10"></a>     <span class="dt">rmSingles =</span> <span class="ot">TRUE</span>,</span>
<span id="cb200-11"><a href="network-analysis-1.html#cb200-11"></a>     <span class="dt">labelScale =</span> <span class="ot">FALSE</span>,</span>
<span id="cb200-12"><a href="network-analysis-1.html#cb200-12"></a>     <span class="dt">cexLabels =</span> <span class="fl">1.6</span>,</span>
<span id="cb200-13"><a href="network-analysis-1.html#cb200-13"></a>     <span class="dt">nodeSizeSpread =</span> <span class="dv">3</span>,</span>
<span id="cb200-14"><a href="network-analysis-1.html#cb200-14"></a>     <span class="dt">cexNodes =</span> <span class="fl">1.5</span>,</span>
<span id="cb200-15"><a href="network-analysis-1.html#cb200-15"></a>     <span class="dt">title1 =</span> <span class="st">&quot;Network on metabolomics with Aitchison distance&quot;</span>, </span>
<span id="cb200-16"><a href="network-analysis-1.html#cb200-16"></a>     <span class="dt">showTitle =</span> <span class="ot">TRUE</span>,</span>
<span id="cb200-17"><a href="network-analysis-1.html#cb200-17"></a>     <span class="dt">cexTitle =</span> <span class="fl">1.5</span>,</span>
<span id="cb200-18"><a href="network-analysis-1.html#cb200-18"></a>     <span class="dt">hubTransp =</span> <span class="dv">50</span>,</span>
<span id="cb200-19"><a href="network-analysis-1.html#cb200-19"></a>     <span class="dt">edgeTranspLow =</span> <span class="dv">60</span>,</span>
<span id="cb200-20"><a href="network-analysis-1.html#cb200-20"></a>     <span class="dt">charToRm =</span> <span class="st">&quot;00000&quot;</span>,</span>
<span id="cb200-21"><a href="network-analysis-1.html#cb200-21"></a>     <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">5</span>))</span>
<span id="cb200-22"><a href="network-analysis-1.html#cb200-22"></a></span>
<span id="cb200-23"><a href="network-analysis-1.html#cb200-23"></a><span class="co"># plot(props_aitchison, </span></span>
<span id="cb200-24"><a href="network-analysis-1.html#cb200-24"></a><span class="co">#      nodeColor = &quot;cluster&quot;, </span></span>
<span id="cb200-25"><a href="network-analysis-1.html#cb200-25"></a><span class="co">#      nodeSize = &quot;eigenvector&quot;,</span></span>
<span id="cb200-26"><a href="network-analysis-1.html#cb200-26"></a><span class="co">#      hubTransp = 50,</span></span>
<span id="cb200-27"><a href="network-analysis-1.html#cb200-27"></a><span class="co">#      edgeTranspLow = 60,</span></span>
<span id="cb200-28"><a href="network-analysis-1.html#cb200-28"></a><span class="co">#      charToRm = &quot;00000&quot;,</span></span>
<span id="cb200-29"><a href="network-analysis-1.html#cb200-29"></a><span class="co">#      mar = c(1, 3, 3, 5))</span></span>
<span id="cb200-30"><a href="network-analysis-1.html#cb200-30"></a></span>
<span id="cb200-31"><a href="network-analysis-1.html#cb200-31"></a><span class="co"># get green color with 50% transparency</span></span>
<span id="cb200-32"><a href="network-analysis-1.html#cb200-32"></a>green2 &lt;-<span class="st"> </span><span class="kw">colToTransp</span>(<span class="st">&quot;#009900&quot;</span>, <span class="dv">40</span>)</span>
<span id="cb200-33"><a href="network-analysis-1.html#cb200-33"></a></span>
<span id="cb200-34"><a href="network-analysis-1.html#cb200-34"></a><span class="kw">legend</span>(<span class="fl">0.4</span>, <span class="fl">1.1</span>,</span>
<span id="cb200-35"><a href="network-analysis-1.html#cb200-35"></a>       <span class="dt">cex =</span> <span class="fl">1.5</span>,</span>
<span id="cb200-36"><a href="network-analysis-1.html#cb200-36"></a>       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;high similarity (low Aitchison distance)&quot;</span>,</span>
<span id="cb200-37"><a href="network-analysis-1.html#cb200-37"></a>                  <span class="st">&quot;low similarity (high Aitchison distance)&quot;</span>), </span>
<span id="cb200-38"><a href="network-analysis-1.html#cb200-38"></a>       <span class="dt">lty =</span> <span class="dv">1</span>, </span>
<span id="cb200-39"><a href="network-analysis-1.html#cb200-39"></a>       <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),</span>
<span id="cb200-40"><a href="network-analysis-1.html#cb200-40"></a>       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;darkgreen&quot;</span>, green2),</span>
<span id="cb200-41"><a href="network-analysis-1.html#cb200-41"></a>       <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="OMics-analysis-workflow_files/figure-html/unnamed-chunk-121-1.png" width="1152" /></p>
</div>
</div>
<div id="network-comparison" class="section level2 hasAnchor">
<h2><span class="header-section-number">4.7</span> Network comparison<a href="network-analysis-1.html#network-comparison" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Comparing two networks by <strong>NetCoMi</strong>.</p>
<div id="data-preparing" class="section level3 hasAnchor">
<h3><span class="header-section-number">4.7.1</span> Data preparing<a href="network-analysis-1.html#data-preparing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="network-analysis-1.html#cb201-1"></a>group_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mild&quot;</span>, <span class="st">&quot;Severe&quot;</span>)</span>
<span id="cb201-2"><a href="network-analysis-1.html#cb201-2"></a></span>
<span id="cb201-3"><a href="network-analysis-1.html#cb201-3"></a>se_filter_subset &lt;-<span class="st"> </span>se_filter[, se_filter<span class="op">$</span>group <span class="op">%in%</span><span class="st"> </span>group_names]</span>
<span id="cb201-4"><a href="network-analysis-1.html#cb201-4"></a>se_filter_subset<span class="op">$</span>group &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">as.character</span>(se_filter_subset<span class="op">$</span>group))</span>
<span id="cb201-5"><a href="network-analysis-1.html#cb201-5"></a>features_tab &lt;-<span class="st"> </span>SummarizedExperiment<span class="op">::</span><span class="kw">assay</span>(se_filter_subset) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb201-6"><a href="network-analysis-1.html#cb201-6"></a><span class="st">  </span><span class="kw">t</span>()</span>
<span id="cb201-7"><a href="network-analysis-1.html#cb201-7"></a>features_tab[<span class="kw">is.na</span>(features_tab)] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb201-8"><a href="network-analysis-1.html#cb201-8"></a></span>
<span id="cb201-9"><a href="network-analysis-1.html#cb201-9"></a>group_vector &lt;-<span class="st"> </span>se_filter_subset<span class="op">$</span>group</span></code></pre></div>
</div>
<div id="building-network-model-5" class="section level3 hasAnchor">
<h3><span class="header-section-number">4.7.2</span> Building network model<a href="network-analysis-1.html#building-network-model-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="network-analysis-1.html#cb202-1"></a>net_group &lt;-<span class="st"> </span><span class="kw">netConstruct</span>(features_tab, </span>
<span id="cb202-2"><a href="network-analysis-1.html#cb202-2"></a>                          <span class="dt">group =</span> group_vector, </span>
<span id="cb202-3"><a href="network-analysis-1.html#cb202-3"></a>                          <span class="dt">measure =</span> <span class="st">&quot;pearson&quot;</span>,</span>
<span id="cb202-4"><a href="network-analysis-1.html#cb202-4"></a>                          <span class="dt">normMethod =</span> <span class="st">&quot;clr&quot;</span>, </span>
<span id="cb202-5"><a href="network-analysis-1.html#cb202-5"></a>                          <span class="dt">zeroMethod =</span> <span class="st">&quot;multRepl&quot;</span>,</span>
<span id="cb202-6"><a href="network-analysis-1.html#cb202-6"></a>                          <span class="dt">sparsMethod =</span> <span class="st">&quot;threshold&quot;</span>, </span>
<span id="cb202-7"><a href="network-analysis-1.html#cb202-7"></a>                          <span class="dt">thresh =</span> <span class="fl">0.3</span>,</span>
<span id="cb202-8"><a href="network-analysis-1.html#cb202-8"></a>                          <span class="dt">verbose =</span> <span class="dv">3</span>,</span>
<span id="cb202-9"><a href="network-analysis-1.html#cb202-9"></a>                          <span class="dt">seed =</span> <span class="dv">123</span>)</span></code></pre></div>
<pre><code>## 48 taxa and 26 samples remaining.</code></pre>
<pre><code>## 
## Zero treatment:</code></pre>
<pre><code>## Execute multRepl() ... Done.
## 
## Normalization:
## Execute clr(){SpiecEasi} ... Done.
## 
## Calculate &#39;pearson&#39; associations ... Done.
## 
## Calculate associations in group 2 ... Done.
## 
## Sparsify associations via &#39;threshold&#39; ... Done.
## 
## Sparsify associations in group 2 ... Done.</code></pre>
</div>
<div id="network-analysis-2" class="section level3 hasAnchor">
<h3><span class="header-section-number">4.7.3</span> Network analysis<a href="network-analysis-1.html#network-analysis-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="network-analysis-1.html#cb206-1"></a>props_group &lt;-<span class="st"> </span><span class="kw">netAnalyze</span>(net_group, </span>
<span id="cb206-2"><a href="network-analysis-1.html#cb206-2"></a>                          <span class="dt">centrLCC =</span> <span class="ot">FALSE</span>,</span>
<span id="cb206-3"><a href="network-analysis-1.html#cb206-3"></a>                          <span class="dt">avDissIgnoreInf =</span> <span class="ot">TRUE</span>,</span>
<span id="cb206-4"><a href="network-analysis-1.html#cb206-4"></a>                          <span class="dt">sPathNorm =</span> <span class="ot">FALSE</span>,</span>
<span id="cb206-5"><a href="network-analysis-1.html#cb206-5"></a>                          <span class="dt">clustMethod =</span> <span class="st">&quot;cluster_fast_greedy&quot;</span>,</span>
<span id="cb206-6"><a href="network-analysis-1.html#cb206-6"></a>                          <span class="dt">hubPar =</span> <span class="kw">c</span>(<span class="st">&quot;degree&quot;</span>, <span class="st">&quot;between&quot;</span>, <span class="st">&quot;closeness&quot;</span>),</span>
<span id="cb206-7"><a href="network-analysis-1.html#cb206-7"></a>                          <span class="dt">hubQuant =</span> <span class="fl">0.9</span>,</span>
<span id="cb206-8"><a href="network-analysis-1.html#cb206-8"></a>                          <span class="dt">lnormFit =</span> <span class="ot">TRUE</span>,</span>
<span id="cb206-9"><a href="network-analysis-1.html#cb206-9"></a>                          <span class="dt">normDeg =</span> <span class="ot">FALSE</span>,</span>
<span id="cb206-10"><a href="network-analysis-1.html#cb206-10"></a>                          <span class="dt">normBetw =</span> <span class="ot">FALSE</span>,</span>
<span id="cb206-11"><a href="network-analysis-1.html#cb206-11"></a>                          <span class="dt">normClose =</span> <span class="ot">FALSE</span>,</span>
<span id="cb206-12"><a href="network-analysis-1.html#cb206-12"></a>                          <span class="dt">normEigen =</span> <span class="ot">FALSE</span>)</span>
<span id="cb206-13"><a href="network-analysis-1.html#cb206-13"></a></span>
<span id="cb206-14"><a href="network-analysis-1.html#cb206-14"></a><span class="kw">summary</span>(props_group)</span></code></pre></div>
<pre><code>## 
## Component sizes
## ```````````````
## Group 1:        
## size: 48
##    #:  1
## 
## Group 2:        
## size: 48
##    #:  1
## ______________________________
## Global network properties
## `````````````````````````
##                          group &#39;1&#39; group &#39;2&#39;
## Number of components       1.00000   1.00000
## Clustering coefficient     0.50151   0.48747
## Modularity                 0.15580   0.08807
## Positive edge percentage  51.11607  49.24078
## Edge density               0.39716   0.40869
## Natural connectivity       0.09563   0.08721
## Vertex connectivity        9.00000   7.00000
## Edge connectivity          9.00000   7.00000
## Average dissimilarity*     0.67288   0.68152
## Average path length**      0.92286   0.91581
## 
##  *Dissimilarity = 1 - edge weight
## **Path length: Sum of dissimilarities along the path
## 
## ______________________________
## Clusters
## - In the whole network
## - Algorithm: cluster_fast_greedy
## ```````````````````````````````` 
## group &#39;1&#39;:                
## name: 1  2  3  4
##    #: 6 15 14 13
## 
## group &#39;2&#39;:                
## name:  1  2  3 4
##    #: 18 10 12 8
## 
## ______________________________
## Hubs
## - In alphabetical/numerical order
## - Based on log-normal quantiles of centralities
## ```````````````````````````````````````````````
## No hubs detected.
## ______________________________
## Centrality measures
## - In decreasing order
## - Computed for the complete network
## ````````````````````````````````````
## Degree (unnormalized):
##          group &#39;1&#39; group &#39;2&#39;
##  M_48258        29        19
##  M_42398        26        25
##  M_47118        26        27
##  M_35186        25        22
##  M_55072        24        21
##             ______    ______
##  M_47118        26        27
##  M_19130        14        26
##  M_42446        18        26
##  M_33230        22        25
##  M_52452        23        25
## 
## Betweenness centrality (unnormalized):
##          group &#39;1&#39; group &#39;2&#39;
##  M_35186        51         5
##  M_42450        31        27
##  M_52452        31        18
##  M_42398        31        20
##  M_35253        31         5
##             ______    ______
##  M_19130         5        34
##  M_33230         3        32
##  M_63361         5        31
##  M_53189         7        27
##  M_42450        31        27
## 
## Closeness centrality (unnormalized):
##          group &#39;1&#39; group &#39;2&#39;
##  M_35253  71.79398  51.58148
##  M_42398   70.9484  63.74822
##  M_33961  68.32261  55.35701
##  M_48258  67.49245   61.7771
##  M_33955  66.93392  57.32211
##             ______    ______
##  M_52447  63.54214  66.40753
##  M_52464  62.24541  65.07936
##  M_33230  62.53671  63.84338
##  M_42398   70.9484  63.74822
##  M_47118   64.7125  63.10391
## 
## Eigenvector centrality (unnormalized):
##          group &#39;1&#39; group &#39;2&#39;
##  M_42398   0.26682   0.21086
##  M_35253   0.26167   0.08052
##  M_48258   0.25696    0.1782
##  M_35186   0.23664   0.20434
##  M_33961   0.23245   0.11227
##             ______    ______
##  M_33230   0.18321   0.21563
##  M_47118   0.20899   0.21435
##  M_42398   0.26682   0.21086
##  M_35186   0.23664   0.20434
##  M_52447   0.13304   0.18604</code></pre>
</div>
<div id="visualizing-the-network-6" class="section level3 hasAnchor">
<h3><span class="header-section-number">4.7.4</span> Visualizing the network<a href="network-analysis-1.html#visualizing-the-network-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="network-analysis-1.html#cb208-1"></a><span class="kw">plot</span>(props_group, </span>
<span id="cb208-2"><a href="network-analysis-1.html#cb208-2"></a>     <span class="dt">sameLayout =</span> <span class="ot">TRUE</span>, </span>
<span id="cb208-3"><a href="network-analysis-1.html#cb208-3"></a>     <span class="dt">layoutGroup =</span> <span class="dv">1</span>,</span>
<span id="cb208-4"><a href="network-analysis-1.html#cb208-4"></a>     <span class="dt">rmSingles =</span> <span class="st">&quot;inboth&quot;</span>, </span>
<span id="cb208-5"><a href="network-analysis-1.html#cb208-5"></a>     <span class="dt">nodeSize =</span> <span class="st">&quot;mclr&quot;</span>, </span>
<span id="cb208-6"><a href="network-analysis-1.html#cb208-6"></a>     <span class="dt">labelScale =</span> <span class="ot">FALSE</span>,</span>
<span id="cb208-7"><a href="network-analysis-1.html#cb208-7"></a>     <span class="dt">cexNodes =</span> <span class="dv">1</span>, </span>
<span id="cb208-8"><a href="network-analysis-1.html#cb208-8"></a>     <span class="dt">cexLabels =</span> <span class="fl">1.5</span>,</span>
<span id="cb208-9"><a href="network-analysis-1.html#cb208-9"></a>     <span class="dt">cexHubLabels =</span> <span class="dv">2</span>,</span>
<span id="cb208-10"><a href="network-analysis-1.html#cb208-10"></a>     <span class="dt">cexTitle =</span> <span class="dv">2</span>,</span>
<span id="cb208-11"><a href="network-analysis-1.html#cb208-11"></a>     <span class="dt">groupNames =</span> group_names,</span>
<span id="cb208-12"><a href="network-analysis-1.html#cb208-12"></a>     <span class="dt">hubBorderCol  =</span> <span class="st">&quot;gray40&quot;</span>)</span>
<span id="cb208-13"><a href="network-analysis-1.html#cb208-13"></a></span>
<span id="cb208-14"><a href="network-analysis-1.html#cb208-14"></a><span class="kw">legend</span>(<span class="st">&quot;bottom&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;estimated association:&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;+&quot;</span>, <span class="st">&quot;-&quot;</span>), </span>
<span id="cb208-15"><a href="network-analysis-1.html#cb208-15"></a>       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;#009900&quot;</span>,<span class="st">&quot;red&quot;</span>), <span class="dt">inset =</span> <span class="fl">0.04</span>, <span class="dt">cex =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">4</span>, </span>
<span id="cb208-16"><a href="network-analysis-1.html#cb208-16"></a>       <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">horiz =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="OMics-analysis-workflow_files/figure-html/unnamed-chunk-125-1.png" width="1920" /></p>
</div>
<div id="quantitative-network-comparison" class="section level3 hasAnchor">
<h3><span class="header-section-number">4.7.5</span> Quantitative network comparison<a href="network-analysis-1.html#quantitative-network-comparison" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="network-analysis-1.html#cb209-1"></a>comp_group &lt;-<span class="st"> </span><span class="kw">netCompare</span>(props_group, <span class="dt">permTest =</span> <span class="ot">FALSE</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb209-2"><a href="network-analysis-1.html#cb209-2"></a></span>
<span id="cb209-3"><a href="network-analysis-1.html#cb209-3"></a><span class="kw">summary</span>(comp_group, </span>
<span id="cb209-4"><a href="network-analysis-1.html#cb209-4"></a>        <span class="dt">groupNames =</span> group_names,</span>
<span id="cb209-5"><a href="network-analysis-1.html#cb209-5"></a>        <span class="dt">showCentr =</span> <span class="kw">c</span>(<span class="st">&quot;degree&quot;</span>, <span class="st">&quot;between&quot;</span>, <span class="st">&quot;closeness&quot;</span>), </span>
<span id="cb209-6"><a href="network-analysis-1.html#cb209-6"></a>        <span class="dt">numbNodes =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## 
## Comparison of Network Properties
## ----------------------------------
## CALL: 
## netCompare(x = props_group, permTest = FALSE, verbose = FALSE)
## 
## ______________________________
## Global network properties
## `````````````````````````
##                            Mild   Severe    difference
## Number of components      1.000    1.000         0.000
## Clustering coefficient    0.502    0.487         0.014
## Moduarity                 0.156    0.088         0.068
## Positive edge percentage 51.116   49.241         1.875
## Edge density              0.397    0.409         0.012
## Natural connectivity      0.096    0.087         0.008
## Vertex connectivity       9.000    7.000         2.000
## Edge connectivity         9.000    7.000         2.000
## Average dissimilarity*    0.673    0.682         0.009
## Average path length**     0.923    0.916         0.007
## -----
##  *: Dissimilarity = 1 - edge weight
## **Path length: Sum of dissimilarities along the path
## 
## ______________________________
## Jaccard index (similarity betw. sets of most central nodes)
## ``````````````````````````````````````````````````````````
##                     Jacc   P(&lt;=Jacc)     P(&gt;=Jacc)   
## degree             0.278    0.412243      0.768928   
## betweenness centr. 0.120    0.014890 *    0.996495   
## closeness centr.   0.300    0.479343      0.702786   
## eigenvec. centr.   0.444    0.892398      0.223260   
## hub taxa           0.000    1.000000      1.000000   
## -----
## Jaccard index ranges from 0 (compl. different) to 1 (sets equal)
## 
## ______________________________
## Adjusted Rand index (similarity betw. clusterings)
## ``````````````````````````````````````````````````
##    ARI       p-value
##  0.121             0
## -----
## ARI in [-1,1] with ARI=1: perfect agreement betw. clusterings,
##                    ARI=0: expected for two random clusterings
## p-value: two-tailed test with null hypothesis ARI=0
## 
## ______________________________
## Centrality measures
## - In decreasing order
## - Computed for the complete network
## ````````````````````````````````````
## Degree (unnormalized):
##         Mild Severe abs.diff.
## M_19130   14     26        12
## M_19266   21     10        11
## M_48258   29     19        10
## M_49617   10     19         9
## M_35253   24     15         9
## 
## Betweenness centrality (unnormalized):
##         Mild Severe abs.diff.
## M_35186   51      5        46
## M_19130    5     34        29
## M_33230    3     32        29
## M_63361    5     31        26
## M_53229   27      1        26
## 
## Closeness centrality (unnormalized):
##           Mild Severe abs.diff.
## M_35253 71.794 51.581    20.213
## M_33961 68.323 55.357    12.966
## M_49617 46.281 57.240    10.958
## M_53189 49.398 59.611    10.213
## M_33955 66.934 57.322     9.612
## 
## _________________________________________________________
## Significance codes: ***: 0.001, **: 0.01, *: 0.05, .: 0.1</code></pre>
</div>
</div>
<div id="systematic-information" class="section level2 hasAnchor">
<h2><span class="header-section-number">4.8</span> Systematic Information<a href="network-analysis-1.html#systematic-information" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="network-analysis-1.html#cb211-1"></a>devtools<span class="op">::</span><span class="kw">session_info</span>()</span></code></pre></div>
<pre><code>## ─ Session info ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
##  setting  value
##  version  R version 3.6.3 (2020-02-29)
##  os       Ubuntu 16.04.7 LTS
##  system   x86_64, linux-gnu
##  ui       RStudio
##  language (EN)
##  collate  en_IN.UTF-8
##  ctype    en_IN.UTF-8
##  tz       Asia/Hong_Kong
##  date     2022-08-08
##  rstudio  1.1.419 (server)
##  pandoc   2.7.3 @ /usr/bin/ (via rmarkdown)
## 
## ─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
##  ! package              * version    date (UTC) lib source
##    abind                  1.4-5      2016-07-21 [2] CRAN (R 3.6.3)
##    ade4                   1.7-19     2022-04-19 [2] CRAN (R 3.6.3)
##    annotate               1.64.0     2019-10-29 [2] Bioconductor
##    AnnotationDbi          1.48.0     2019-10-29 [2] Bioconductor
##    ape                    5.6-2      2022-03-02 [2] CRAN (R 3.6.3)
##    assertthat             0.2.1      2019-03-21 [2] CRAN (R 3.6.3)
##    backports              1.4.1      2021-12-13 [2] CRAN (R 3.6.3)
##    base64enc              0.1-3      2015-07-28 [2] CRAN (R 3.6.3)
##    Biobase              * 2.46.0     2019-10-29 [2] Bioconductor
##    BiocGenerics         * 0.32.0     2019-10-29 [2] Bioconductor
##    BiocParallel         * 1.20.1     2019-12-21 [2] Bioconductor
##    biomformat             1.14.0     2019-10-29 [2] Bioconductor
##    Biostrings             2.54.0     2019-10-29 [2] Bioconductor
##    bit                    4.0.4      2020-08-04 [2] CRAN (R 3.6.3)
##    bit64                  4.0.5      2020-08-30 [2] CRAN (R 3.6.3)
##    bitops                 1.0-7      2021-04-24 [2] CRAN (R 3.6.3)
##    blob                   1.2.3      2022-04-10 [2] CRAN (R 3.6.3)
##    bookdown               0.27       2022-06-14 [1] CRAN (R 3.6.3)
##    brio                   1.1.3      2021-11-30 [2] CRAN (R 3.6.3)
##    broom                  0.8.0      2022-04-13 [2] CRAN (R 3.6.3)
##    bslib                  0.3.1      2021-10-06 [2] CRAN (R 3.6.3)
##    cachem                 1.0.6      2021-08-19 [2] CRAN (R 3.6.3)
##    callr                  3.7.0      2021-04-20 [2] CRAN (R 3.6.3)
##    car                    3.0-13     2022-05-02 [2] CRAN (R 3.6.3)
##    carData                3.0-5      2022-01-06 [2] CRAN (R 3.6.3)
##    caTools                1.18.2     2021-03-28 [2] CRAN (R 3.6.3)
##    cccd                   1.6        2022-04-08 [1] CRAN (R 3.6.3)
##    cellranger             1.1.0      2016-07-27 [2] CRAN (R 3.6.3)
##    checkmate              2.1.0      2022-04-21 [2] CRAN (R 3.6.3)
##    circlize             * 0.4.15     2022-05-10 [2] CRAN (R 3.6.3)
##    cli                    3.3.0      2022-04-25 [2] CRAN (R 3.6.3)
##    clue                   0.3-61     2022-05-30 [2] CRAN (R 3.6.3)
##    cluster                2.1.0      2019-06-19 [2] CRAN (R 3.6.3)
##    codetools              0.2-16     2018-12-24 [2] CRAN (R 3.6.3)
##    coin                   1.4-2      2021-10-08 [2] CRAN (R 3.6.3)
##    colorspace             2.0-3      2022-02-21 [2] CRAN (R 3.6.3)
##    ComplexHeatmap       * 2.2.0      2019-10-29 [2] Bioconductor
##    corpcor                1.6.10     2021-09-16 [2] CRAN (R 3.6.3)
##    cowplot              * 1.1.1      2020-12-30 [2] CRAN (R 3.6.3)
##    crayon                 1.5.1      2022-03-26 [2] CRAN (R 3.6.3)
##    crosstalk              1.2.0      2021-11-04 [2] CRAN (R 3.6.3)
##    dada2                * 1.14.1     2020-02-22 [2] Bioconductor
##    data.table             1.14.2     2021-09-27 [2] CRAN (R 3.6.3)
##    DBI                    1.1.2      2021-12-20 [2] CRAN (R 3.6.3)
##    dbplyr                 2.1.1      2021-04-06 [2] CRAN (R 3.6.3)
##    DelayedArray         * 0.12.3     2020-04-09 [2] Bioconductor
##    deldir                 1.0-6      2021-10-23 [2] CRAN (R 3.6.3)
##    desc                   1.4.1      2022-03-06 [2] CRAN (R 3.6.3)
##    DESeq2               * 1.26.0     2019-10-29 [2] Bioconductor
##    devtools               2.4.3      2021-11-30 [2] CRAN (R 3.6.3)
##    digest                 0.6.29     2021-12-01 [2] CRAN (R 3.6.3)
##    doParallel             1.0.17     2022-02-07 [2] CRAN (R 3.6.3)
##    doSNOW                 1.0.20     2022-02-04 [1] CRAN (R 3.6.3)
##    dplyr                * 1.0.9      2022-04-28 [2] CRAN (R 3.6.3)
##    DT                   * 0.23       2022-05-10 [2] CRAN (R 3.6.3)
##    dynamicTreeCut       * 1.63-1     2016-03-11 [1] CRAN (R 3.6.3)
##    edgeR                  3.28.1     2020-02-26 [2] Bioconductor
##    ellipsis               0.3.2      2021-04-29 [2] CRAN (R 3.6.3)
##    EnhancedVolcano      * 1.4.0      2019-10-29 [2] Bioconductor
##    evaluate               0.15       2022-02-18 [2] CRAN (R 3.6.3)
##    fansi                  1.0.3      2022-03-24 [2] CRAN (R 3.6.3)
##    farver                 2.1.0      2021-02-28 [2] CRAN (R 3.6.3)
##    fastcluster          * 1.2.3      2021-05-24 [1] CRAN (R 3.6.3)
##    fastmap                1.1.0      2021-01-25 [2] CRAN (R 3.6.3)
##    fdrtool                1.2.17     2021-11-13 [2] CRAN (R 3.6.3)
##    filematrix             1.3        2018-02-27 [1] CRAN (R 3.6.3)
##    FNN                    1.1.3.1    2022-05-23 [1] CRAN (R 3.6.3)
##    forcats              * 0.5.1      2021-01-27 [2] CRAN (R 3.6.3)
##    foreach                1.5.2      2022-02-02 [2] CRAN (R 3.6.3)
##    foreign                0.8-75     2020-01-20 [2] CRAN (R 3.6.3)
##    Formula                1.2-4      2020-10-16 [2] CRAN (R 3.6.3)
##    fs                     1.5.2      2021-12-08 [2] CRAN (R 3.6.3)
##    genefilter             1.68.0     2019-10-29 [2] Bioconductor
##    geneplotter            1.64.0     2019-10-29 [2] Bioconductor
##    generics               0.1.2      2022-01-31 [2] CRAN (R 3.6.3)
##    GenomeInfoDb         * 1.22.1     2020-03-27 [2] Bioconductor
##    GenomeInfoDbData       1.2.2      2020-08-24 [2] Bioconductor
##    GenomicAlignments      1.22.1     2019-11-12 [2] Bioconductor
##    GenomicRanges        * 1.38.0     2019-10-29 [2] Bioconductor
##    GetoptLong             1.0.5      2020-12-15 [2] CRAN (R 3.6.3)
##    ggExtra              * 0.10.0     2022-03-23 [2] CRAN (R 3.6.3)
##    ggforce                0.3.3      2021-03-05 [2] CRAN (R 3.6.3)
##    ggplot2              * 3.3.6      2022-05-03 [2] CRAN (R 3.6.3)
##    ggpubr               * 0.4.0      2020-06-27 [2] CRAN (R 3.6.3)
##    ggraph               * 2.0.5      2021-02-23 [1] CRAN (R 3.6.3)
##    ggrepel              * 0.9.1      2021-01-15 [2] CRAN (R 3.6.3)
##    ggsci                * 2.9        2018-05-14 [2] CRAN (R 3.6.3)
##    ggsignif               0.6.3      2021-09-09 [2] CRAN (R 3.6.3)
##    glasso                 1.11       2019-10-01 [1] CRAN (R 3.6.3)
##    glmnet                 4.0        2020-05-14 [2] CRAN (R 3.6.3)
##    GlobalOptions          0.1.2      2020-06-10 [2] CRAN (R 3.6.3)
##    glue                   1.6.2      2022-02-24 [2] CRAN (R 3.6.3)
##    GO.db                  3.10.0     2022-06-29 [1] Bioconductor
##    gplots                 3.1.3      2022-04-25 [2] CRAN (R 3.6.3)
##    graphlayouts           0.8.0      2022-01-03 [1] CRAN (R 3.6.3)
##    gridExtra              2.3        2017-09-09 [2] CRAN (R 3.6.3)
##    gtable                 0.3.0      2019-03-25 [2] CRAN (R 3.6.3)
##    gtools                 3.9.2.1    2022-05-23 [2] CRAN (R 3.6.3)
##    haven                  2.5.0      2022-04-15 [2] CRAN (R 3.6.3)
##    highr                  0.9        2021-04-16 [2] CRAN (R 3.6.3)
##    Hmisc                  4.7-0      2022-04-19 [2] CRAN (R 3.6.3)
##    hms                    1.1.1      2021-09-26 [2] CRAN (R 3.6.3)
##    htmlTable              2.4.0      2022-01-04 [2] CRAN (R 3.6.3)
##    htmltools              0.5.2      2021-08-25 [2] CRAN (R 3.6.3)
##    htmlwidgets            1.5.4      2021-09-08 [2] CRAN (R 3.6.3)
##    httpuv                 1.6.5      2022-01-05 [2] CRAN (R 3.6.3)
##    httr                   1.4.3      2022-05-04 [2] CRAN (R 3.6.3)
##    huge                   1.3.5      2021-06-30 [1] CRAN (R 3.6.3)
##    hwriter                1.3.2.1    2022-04-08 [2] CRAN (R 3.6.3)
##    igraph               * 1.3.1      2022-04-20 [2] CRAN (R 3.6.3)
##    IHW                    1.14.0     2019-10-29 [2] Bioconductor
##    impute                 1.60.0     2019-10-29 [2] Bioconductor
##    IRanges              * 2.20.2     2020-01-13 [2] Bioconductor
##    irlba                  2.3.5      2021-12-06 [1] CRAN (R 3.6.3)
##    iterators              1.0.14     2022-02-05 [2] CRAN (R 3.6.3)
##    jpeg                   0.1-9      2021-07-24 [2] CRAN (R 3.6.3)
##    jquerylib              0.1.4      2021-04-26 [2] CRAN (R 3.6.3)
##    jsonlite               1.8.0      2022-02-22 [2] CRAN (R 3.6.3)
##    KernSmooth             2.23-16    2019-10-15 [2] CRAN (R 3.6.3)
##    knitr                  1.39       2022-04-26 [2] CRAN (R 3.6.3)
##    labeling               0.4.2      2020-10-20 [2] CRAN (R 3.6.3)
##    later                  1.3.0      2021-08-18 [2] CRAN (R 3.6.3)
##    lattice              * 0.20-38    2018-11-04 [2] CRAN (R 3.6.3)
##    latticeExtra           0.6-29     2019-12-19 [2] CRAN (R 3.6.3)
##    lavaan                 0.6-12     2022-07-04 [1] CRAN (R 3.6.3)
##    lazyeval               0.2.2      2019-03-15 [2] CRAN (R 3.6.3)
##    libcoin                1.0-9      2021-09-27 [2] CRAN (R 3.6.3)
##    lifecycle              1.0.1      2021-09-24 [2] CRAN (R 3.6.3)
##    limma                  3.42.2     2020-02-03 [2] Bioconductor
##    locfit                 1.5-9.4    2020-03-25 [2] CRAN (R 3.6.3)
##    lpsymphony             1.14.0     2019-10-29 [2] Bioconductor (R 3.6.3)
##    lubridate              1.8.0      2021-10-07 [2] CRAN (R 3.6.3)
##    magrittr             * 2.0.3      2022-03-30 [2] CRAN (R 3.6.3)
##    MASS                   7.3-51.5   2019-12-20 [2] CRAN (R 3.6.3)
##    Matrix                 1.2-18     2019-11-27 [2] CRAN (R 3.6.3)
##    matrixStats          * 0.62.0     2022-04-19 [2] CRAN (R 3.6.3)
##    memoise                2.0.1      2021-11-26 [2] CRAN (R 3.6.3)
##    metagenomeSeq          1.28.2     2020-02-03 [2] Bioconductor
##    mgcv                   1.8-31     2019-11-09 [2] CRAN (R 3.6.3)
##    mime                   0.12       2021-09-28 [2] CRAN (R 3.6.3)
##    miniUI                 0.1.1.1    2018-05-18 [2] CRAN (R 3.6.3)
##    mixedCCA               1.5.2      2022-08-04 [1] Github (irinagain/mixedCCA@c6d41a3)
##    mnormt                 2.0.2      2020-09-01 [2] CRAN (R 3.6.1)
##    modelr                 0.1.8      2020-05-19 [2] CRAN (R 3.6.3)
##    modeltools             0.2-23     2020-03-05 [2] CRAN (R 3.6.3)
##    multcomp               1.4-19     2022-04-26 [2] CRAN (R 3.6.3)
##    multtest               2.42.0     2019-10-29 [2] Bioconductor
##    munsell                0.5.0      2018-06-12 [2] CRAN (R 3.6.3)
##    mvtnorm                1.1-3      2021-10-08 [2] CRAN (R 3.6.3)
##    NADA                   1.6-1.1    2020-03-22 [2] CRAN (R 3.6.3)
##    NetCoMi              * 1.0.3      2022-08-04 [1] Github (stefpeschel/NetCoMi@d4d80d3)
##    nlme                   3.1-144    2020-02-06 [2] CRAN (R 3.6.3)
##    nnet                   7.3-12     2016-02-02 [2] CRAN (R 3.6.3)
##    pbapply                1.5-0      2021-09-16 [2] CRAN (R 3.6.3)
##    pbivnorm               0.6.0      2015-01-23 [1] CRAN (R 3.6.3)
##    pcaPP                  2.0-1      2022-04-26 [2] CRAN (R 3.6.3)
##    permute              * 0.9-7      2022-01-27 [2] CRAN (R 3.6.3)
##    pheatmap               1.0.12     2019-01-04 [2] CRAN (R 3.6.3)
##    phyloseq             * 1.30.0     2019-10-29 [2] Bioconductor
##    pillar                 1.7.0      2022-02-01 [2] CRAN (R 3.6.3)
##    pkgbuild               1.3.1      2021-12-20 [2] CRAN (R 3.6.3)
##    pkgconfig              2.0.3      2019-09-22 [2] CRAN (R 3.6.3)
##    pkgload                1.2.4      2021-11-30 [2] CRAN (R 3.6.3)
##    plotly               * 4.10.0     2021-10-09 [2] CRAN (R 3.6.3)
##    plyr                   1.8.7      2022-03-24 [2] CRAN (R 3.6.3)
##    png                    0.1-7      2013-12-03 [2] CRAN (R 3.6.3)
##    polyclip               1.10-0     2019-03-14 [2] CRAN (R 3.6.3)
##    preprocessCore         1.48.0     2019-10-29 [2] Bioconductor
##    prettyunits            1.1.1      2020-01-24 [2] CRAN (R 3.6.3)
##    processx               3.5.3      2022-03-25 [2] CRAN (R 3.6.3)
##    promises               1.2.0.1    2021-02-11 [2] CRAN (R 3.6.3)
##    proxy                  0.4-26     2021-06-07 [2] CRAN (R 3.6.3)
##    ps                     1.7.0      2022-04-23 [2] CRAN (R 3.6.3)
##    psych                  2.2.5      2022-05-10 [2] CRAN (R 3.6.1)
##    pulsar                 0.3.7      2020-08-07 [1] CRAN (R 3.6.3)
##    purrr                * 0.3.4      2020-04-17 [2] CRAN (R 3.6.3)
##    qgraph                 1.9.2      2022-03-04 [1] CRAN (R 3.6.3)
##    R6                     2.5.1      2021-08-19 [2] CRAN (R 3.6.3)
##    rbibutils              2.2.8      2022-04-11 [1] CRAN (R 3.6.3)
##    RColorBrewer         * 1.1-3      2022-04-03 [2] CRAN (R 3.6.3)
##    Rcpp                 * 1.0.8.3    2022-03-17 [2] CRAN (R 3.6.3)
##    RcppParallel           5.1.5      2022-01-05 [2] CRAN (R 3.6.3)
##    RCurl                  1.98-1.6   2022-02-08 [2] CRAN (R 3.6.3)
##    Rdpack                 2.4        2022-07-20 [1] CRAN (R 3.6.3)
##    readr                * 2.1.2      2022-01-30 [2] CRAN (R 3.6.3)
##    readxl               * 1.4.0      2022-03-28 [2] CRAN (R 3.6.3)
##    remotes                2.4.2      2021-11-30 [2] CRAN (R 3.6.3)
##    reprex                 2.0.1      2021-08-05 [2] CRAN (R 3.6.3)
##    reshape2               1.4.4      2020-04-09 [2] CRAN (R 3.6.3)
##    rhdf5                  2.30.1     2019-11-26 [2] Bioconductor
##    Rhdf5lib               1.8.0      2019-10-29 [2] Bioconductor
##    rJava                  1.0-6      2021-12-10 [1] CRAN (R 3.6.3)
##    rjson                  0.2.20     2018-06-08 [2] CRAN (R 3.6.3)
##    rlang                  1.0.2      2022-03-04 [2] CRAN (R 3.6.3)
##    rmarkdown              2.14       2022-04-25 [2] CRAN (R 3.6.3)
##    rootSolve              1.8.2.3    2021-09-29 [1] CRAN (R 3.6.3)
##    rpart                  4.1-15     2019-04-12 [2] CRAN (R 3.6.3)
##    rprojroot              2.0.3      2022-04-02 [2] CRAN (R 3.6.3)
##    Rsamtools              2.2.3      2020-02-23 [2] Bioconductor
##    RSQLite                2.2.14     2022-05-07 [2] CRAN (R 3.6.3)
##    rstatix                0.7.0      2021-02-13 [2] CRAN (R 3.6.3)
##    rstudioapi             0.13       2020-11-12 [2] CRAN (R 3.6.3)
##    rvest                  1.0.2      2021-10-16 [2] CRAN (R 3.6.3)
##    S4Vectors            * 0.24.4     2020-04-09 [2] Bioconductor
##    sandwich               3.0-1      2021-05-18 [2] CRAN (R 3.6.3)
##    sass                   0.4.1      2022-03-23 [2] CRAN (R 3.6.3)
##    scales                 1.2.0      2022-04-13 [2] CRAN (R 3.6.3)
##    seqinr               * 4.2-16     2022-05-19 [2] CRAN (R 3.6.3)
##    sessioninfo            1.2.2      2021-12-06 [2] CRAN (R 3.6.3)
##    shape                  1.4.6      2021-05-19 [2] CRAN (R 3.6.3)
##  P shiny                  1.7.1      2021-10-02 [2] CRAN (R 3.6.3)
##    ShortRead              1.44.3     2020-02-03 [2] Bioconductor
##    slam                   0.1-50     2022-01-08 [2] CRAN (R 3.6.3)
##    snow                   0.4-4      2021-10-27 [2] CRAN (R 3.6.3)
##    SpiecEasi            * 1.1.2      2022-08-04 [1] Github (zdk123/SpiecEasi@c463727)
##    SPRING               * 1.0.4      2022-08-04 [1] Github (GraceYoon/SPRING@3d641a4)
##    stringi                1.7.6      2021-11-29 [2] CRAN (R 3.6.3)
##    stringr              * 1.4.0      2019-02-10 [2] CRAN (R 3.6.3)
##    SummarizedExperiment * 1.16.1     2019-12-19 [2] Bioconductor
##    survival               3.1-8      2019-12-03 [2] CRAN (R 3.6.3)
##    testthat               3.1.4      2022-04-26 [2] CRAN (R 3.6.3)
##    TH.data                1.1-1      2022-04-26 [2] CRAN (R 3.6.3)
##    tibble               * 3.1.7      2022-05-03 [2] CRAN (R 3.6.3)
##    tidygraph              1.2.1      2022-04-05 [1] CRAN (R 3.6.3)
##    tidyr                * 1.2.0      2022-02-01 [2] CRAN (R 3.6.3)
##    tidyselect             1.1.2      2022-02-21 [2] CRAN (R 3.6.3)
##    tidyverse            * 1.3.1.9000 2021-11-19 [2] Github (tidyverse/tidyverse@663456e)
##    tmvnsim                1.0-2      2016-12-15 [2] CRAN (R 3.6.1)
##    truncnorm              1.0-8      2018-02-27 [2] CRAN (R 3.6.3)
##    tweenr                 1.0.2      2021-03-23 [2] CRAN (R 3.6.3)
##    tzdb                   0.3.0      2022-03-28 [2] CRAN (R 3.6.3)
##    usethis                2.1.6      2022-05-25 [2] CRAN (R 3.6.3)
##    utf8                   1.2.2      2021-07-24 [2] CRAN (R 3.6.3)
##    vctrs                  0.4.1      2022-04-13 [2] CRAN (R 3.6.3)
##    vegan                * 2.6-2      2022-04-17 [2] CRAN (R 3.6.3)
##    VGAM                   1.1-6      2022-02-14 [2] CRAN (R 3.6.3)
##    viridis                0.6.2      2021-10-13 [2] CRAN (R 3.6.3)
##    viridisLite            0.4.0      2021-04-13 [2] CRAN (R 3.6.3)
##    wesanderson          * 0.3.6      2018-04-20 [1] CRAN (R 3.6.3)
##    WGCNA                * 1.71       2022-04-22 [1] CRAN (R 3.6.3)
##    withr                  2.5.0      2022-03-03 [2] CRAN (R 3.6.3)
##    Wrench                 1.4.0      2019-10-29 [2] Bioconductor
##    xfun                   0.31       2022-05-10 [2] CRAN (R 3.6.3)
##    xlsx                 * 0.6.5      2020-11-10 [1] CRAN (R 3.6.3)
##    xlsxjars               0.6.1      2014-08-22 [1] CRAN (R 3.6.3)
##    XMAS2                * 2.1.7.3    2022-08-08 [2] local
##    XML                    3.99-0.3   2020-01-20 [2] CRAN (R 3.6.3)
##    xml2                   1.3.3      2021-11-30 [2] CRAN (R 3.6.3)
##    xtable                 1.8-4      2019-04-21 [2] CRAN (R 3.6.3)
##    XVector                0.26.0     2019-10-29 [2] Bioconductor
##    xviz                 * 1.1.0      2021-04-15 [2] local
##    yaml                   2.3.5      2022-02-21 [2] CRAN (R 3.6.3)
##    zCompositions          1.4.0-1    2022-03-26 [2] CRAN (R 3.6.3)
##    zlibbioc               1.32.0     2019-10-29 [2] Bioconductor
##    zoo                    1.8-10     2022-04-15 [2] CRAN (R 3.6.3)
## 
##  [1] /share/home/zouhua/R/x86_64-pc-linux-gnu-library/3.6
##  [2] /opt/R-3.6.3/lib/R/library
## 
##  P ── Loaded and on-disk path mismatch.
## 
## ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</code></pre>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references">
<div id="ref-peschel2021netcomi">
<p>Peschel, Stefanie, Christian L Müller, Erika von Mutius, Anne-Laure Boulesteix, and Martin Depner. 2021. “NetCoMi: Network Construction and Comparison for Microbiome Data in R.” <em>Briefings in Bioinformatics</em> 22 (4): bbaa290.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="实例展示.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/XbiomeAnalysis/OMicsAnalysis/blob/main/03-Network-Analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["OMics analysis workflow.pdf", "OMics analysis workflow.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
